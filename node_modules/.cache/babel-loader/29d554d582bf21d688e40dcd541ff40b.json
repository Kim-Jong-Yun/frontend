{"ast":null,"code":"var _jsxFileName = \"/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Test/MapComponent.js\";\nimport React, { useEffect, useRef } from 'react';\nfunction MapComponent({\n  robots,\n  mapUrl\n}) {\n  const canvasRef = useRef(null);\n  const mapImageRef = useRef(null);\n  const mapResolution = 0.05; // 기본 해상도 값\n\n  const drawMapAndRobots = () => {\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      console.error('캔버스 요소를 찾을 수 없습니다.');\n      return;\n    }\n    const ctx = canvas.getContext('2d');\n\n    // mapImageRef.current에 새 이미지 객체를 저장합니다.\n    mapImageRef.current = new Image();\n    mapImageRef.current.src = mapUrl;\n    mapImageRef.current.onload = () => {\n      // 캔버스 크기를 CSS 크기에 맞춥니다.\n      const canvasWidth = canvas.clientWidth;\n      const canvasHeight = canvas.clientHeight;\n      canvas.width = canvasWidth;\n      canvas.height = canvasHeight;\n\n      // 이미지의 원본 크기로 그립니다.\n      ctx.drawImage(mapImageRef.current, 0, 0);\n      robots.forEach(robot => {\n        var _robot$status, _robot$status2, _robot$status3;\n        const {\n          x,\n          y\n        } = robot.location;\n        const {\n          mapX,\n          mapY\n        } = worldToMap(x, y, mapResolution);\n        let robotColor = 'gray';\n        if (((_robot$status = robot.status) === null || _robot$status === void 0 ? void 0 : _robot$status.state) === 'Tasking') {\n          robotColor = 'blue';\n        } else if (((_robot$status2 = robot.status) === null || _robot$status2 === void 0 ? void 0 : _robot$status2.state) === 'Waiting') {\n          robotColor = 'yellow';\n        } else if (((_robot$status3 = robot.status) === null || _robot$status3 === void 0 ? void 0 : _robot$status3.state) === 'Error') {\n          robotColor = 'red';\n        }\n        ctx.fillStyle = robotColor;\n        ctx.beginPath();\n        ctx.arc(mapX, mapY, 5, 0, 2 * Math.PI);\n        ctx.fill();\n      });\n    };\n    mapImageRef.current.onerror = err => {\n      console.error('지도 이미지를 그리는 중 오류 발생:', err);\n    };\n  };\n  const worldToMap = (x, y, resolution) => {\n    const mapImage = mapImageRef.current;\n    if (!mapImage || !mapImage.complete) {\n      console.error('지도 이미지가 아직 로드되지 않았습니다.');\n      return {\n        mapX: 0,\n        mapY: 0\n      };\n    }\n    const mapWidth = mapImage.width;\n    const mapHeight = mapImage.height;\n    const mapX = (x + mapWidth * resolution / 2) / resolution;\n    const mapY = mapHeight - (y + mapHeight * resolution / 2) / resolution;\n    return {\n      mapX,\n      mapY\n    };\n  };\n  useEffect(() => {\n    if (mapUrl && robots.length > 0) {\n      drawMapAndRobots(); // 지도 이미지와 로봇 데이터로 맵을 그림\n    }\n  }, [mapUrl, robots]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"map-canvas-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 5\n    }\n  }, mapUrl ? /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    className: \"canvas\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }, \"\\uC9C0\\uB3C4\\uB97C \\uBD88\\uB7EC\\uC624\\uB294 \\uC911...\"));\n}\nexport default MapComponent;","map":{"version":3,"names":["React","useEffect","useRef","MapComponent","robots","mapUrl","canvasRef","mapImageRef","mapResolution","drawMapAndRobots","canvas","current","console","error","ctx","getContext","Image","src","onload","canvasWidth","clientWidth","canvasHeight","clientHeight","width","height","drawImage","forEach","robot","_robot$status","_robot$status2","_robot$status3","x","y","location","mapX","mapY","worldToMap","robotColor","status","state","fillStyle","beginPath","arc","Math","PI","fill","onerror","err","resolution","mapImage","complete","mapWidth","mapHeight","length","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref"],"sources":["/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Test/MapComponent.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\n\nfunction MapComponent({ robots, mapUrl }) {\n  const canvasRef = useRef(null);\n  const mapImageRef = useRef(null);\n  const mapResolution = 0.05; // 기본 해상도 값\n\n  const drawMapAndRobots = () => {\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      console.error('캔버스 요소를 찾을 수 없습니다.');\n      return;\n    }\n\n    const ctx = canvas.getContext('2d');\n\n    // mapImageRef.current에 새 이미지 객체를 저장합니다.\n    mapImageRef.current = new Image();\n    mapImageRef.current.src = mapUrl;\n\n    mapImageRef.current.onload = () => {\n      // 캔버스 크기를 CSS 크기에 맞춥니다.\n      const canvasWidth = canvas.clientWidth;\n      const canvasHeight = canvas.clientHeight;\n      canvas.width = canvasWidth;\n      canvas.height = canvasHeight;\n\n      // 이미지의 원본 크기로 그립니다.\n      ctx.drawImage(mapImageRef.current, 0, 0);\n\n      robots.forEach((robot) => {\n        const { x, y } = robot.location;\n        const { mapX, mapY } = worldToMap(x, y, mapResolution);\n\n        let robotColor = 'gray';\n        if (robot.status?.state === 'Tasking') {\n          robotColor = 'blue';\n        } else if (robot.status?.state === 'Waiting') {\n          robotColor = 'yellow';\n        } else if (robot.status?.state === 'Error') {\n          robotColor = 'red';\n        }\n\n        ctx.fillStyle = robotColor;\n        ctx.beginPath();\n        ctx.arc(mapX, mapY, 5, 0, 2 * Math.PI);\n        ctx.fill();\n      });\n    };\n\n    mapImageRef.current.onerror = (err) => {\n      console.error('지도 이미지를 그리는 중 오류 발생:', err);\n    };\n  };\n\n  const worldToMap = (x, y, resolution) => {\n    const mapImage = mapImageRef.current;\n    if (!mapImage || !mapImage.complete) {\n      console.error('지도 이미지가 아직 로드되지 않았습니다.');\n      return { mapX: 0, mapY: 0 };\n    }\n\n    const mapWidth = mapImage.width;\n    const mapHeight = mapImage.height;\n\n    const mapX = (x + (mapWidth * resolution) / 2) / resolution;\n    const mapY = mapHeight - (y + (mapHeight * resolution) / 2) / resolution;\n    return { mapX, mapY };\n  };\n\n  useEffect(() => {\n    if (mapUrl && robots.length > 0) {\n      drawMapAndRobots(); // 지도 이미지와 로봇 데이터로 맵을 그림\n    }\n  }, [mapUrl, robots]);\n\n  return (\n    <div className=\"map-canvas-container\">\n      {mapUrl ? (\n        <canvas ref={canvasRef} className=\"canvas\"></canvas>\n      ) : (\n        <p>지도를 불러오는 중...</p>\n      )}\n    </div>\n  );\n}\n\nexport default MapComponent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}
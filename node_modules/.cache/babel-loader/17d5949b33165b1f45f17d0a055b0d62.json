{"ast":null,"code":"var _jsxFileName = \"/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Monitor/MonitoringPage.js\";\nimport React, { useEffect, useState } from 'react';\nimport Navbar from '../../components/Common/Navbar';\nimport LogoutButton from '../../components/Common/LogoutButton';\nimport UserInfo from '../../components/Common/UserInfo';\nimport axios from 'axios';\nfunction MonitoringPage() {\n  const [mapUrl, setMapUrl] = useState('');\n  const [robots, setRobots] = useState([]);\n  const [ws, setWs] = useState(null);\n  useEffect(() => {\n    fetchMap();\n    const token = localStorage.getItem('token');\n    const ws = new WebSocket(`ws://172.30.1.40:5559?token=${token}`);\n    ws.onmessage = event => {\n      const updatedRobots = JSON.parse(event.data);\n      setRobots(updatedRobots);\n    };\n    setWs(ws);\n    return () => {\n      if (ws) ws.close();\n    };\n  }, []);\n  const fetchMap = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('No token found, please log in again.');\n      return;\n    }\n    try {\n      const response = await axios.get('http://172.30.1.40:5557/map/monitored/file', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        responseType: 'blob'\n      });\n      const blob = new Blob([response.data], {\n        type: 'image/png'\n      });\n      const url = window.URL.createObjectURL(blob);\n      setMapUrl(url);\n    } catch (error) {\n      console.error('Error fetching map:', error);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      fontFamily: 'Arial, sans-serif',\n      margin: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      marginBottom: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(UserInfo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(LogoutButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"h2\", {\n    style: {\n      textAlign: 'center',\n      margin: '20px 0'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }, \"Monitoring\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      textAlign: 'center',\n      marginBottom: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }, mapUrl && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'relative'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: mapUrl,\n    alt: \"Map\",\n    style: {\n      maxWidth: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }\n  }), robots.map(robot => /*#__PURE__*/React.createElement(\"div\", {\n    key: robot._id,\n    style: {\n      position: 'absolute',\n      left: `${robot.location.x}px`,\n      top: `${robot.location.y}px`,\n      width: '10px',\n      height: '10px',\n      backgroundColor: 'red',\n      borderRadius: '50%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 15\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }, \"Robots\"), /*#__PURE__*/React.createElement(\"ul\", {\n    style: {\n      listStyleType: 'none',\n      padding: 0\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }, robots.map(robot => /*#__PURE__*/React.createElement(\"li\", {\n    key: robot._id,\n    style: {\n      padding: '10px',\n      borderBottom: '1px solid #ccc'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }, robot.name, \" - \", robot.location.x, \", \", robot.location.y)))));\n}\nexport default MonitoringPage;","map":{"version":3,"names":["React","useEffect","useState","Navbar","LogoutButton","UserInfo","axios","MonitoringPage","mapUrl","setMapUrl","robots","setRobots","ws","setWs","fetchMap","token","localStorage","getItem","WebSocket","onmessage","event","updatedRobots","JSON","parse","data","close","alert","response","get","headers","responseType","blob","Blob","type","url","window","URL","createObjectURL","error","console","createElement","style","fontFamily","margin","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","display","justifyContent","marginBottom","textAlign","position","src","alt","maxWidth","map","robot","key","_id","left","location","x","top","y","width","height","backgroundColor","borderRadius","listStyleType","padding","borderBottom","name"],"sources":["/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Monitor/MonitoringPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Navbar from '../../components/Common/Navbar';\nimport LogoutButton from '../../components/Common/LogoutButton';\nimport UserInfo from '../../components/Common/UserInfo';\nimport axios from 'axios';\n\nfunction MonitoringPage() {\n  const [mapUrl, setMapUrl] = useState('');\n  const [robots, setRobots] = useState([]);\n  const [ws, setWs] = useState(null);\n\n  useEffect(() => {\n    fetchMap();\n\n    const token = localStorage.getItem('token');\n    const ws = new WebSocket(`ws://172.30.1.40:5559?token=${token}`);\n    ws.onmessage = (event) => {\n      const updatedRobots = JSON.parse(event.data);\n      setRobots(updatedRobots);\n    };\n    setWs(ws);\n\n    return () => {\n      if (ws) ws.close();\n    };\n  }, []);\n\n  const fetchMap = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('No token found, please log in again.');\n      return;\n    }\n\n    try {\n      const response = await axios.get('http://172.30.1.40:5557/map/monitored/file', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        responseType: 'blob'\n      });\n      const blob = new Blob([response.data], { type: 'image/png' });\n      const url = window.URL.createObjectURL(blob);\n      setMapUrl(url);\n    } catch (error) {\n      console.error('Error fetching map:', error);\n    }\n  };\n\n  return (\n    <div style={{ fontFamily: 'Arial, sans-serif', margin: '20px' }}>\n      <header style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '20px' }}>\n        <UserInfo />\n        <LogoutButton />\n      </header>\n      <div style={{ display: 'flex' }}>\n        <Navbar />\n      </div>\n      <h2 style={{ textAlign: 'center', margin: '20px 0' }}>Monitoring</h2>\n      <div style={{ textAlign: 'center', marginBottom: '20px' }}>\n        {mapUrl && (\n          <div style={{ position: 'relative' }}>\n            <img src={mapUrl} alt=\"Map\" style={{ maxWidth: '100%' }} />\n            {robots.map(robot => (\n              <div\n                key={robot._id}\n                style={{\n                  position: 'absolute',\n                  left: `${robot.location.x}px`,\n                  top: `${robot.location.y}px`,\n                  width: '10px',\n                  height: '10px',\n                  backgroundColor: 'red',\n                  borderRadius: '50%'\n                }}\n              ></div>\n            ))}\n          </div>\n        )}\n      </div>\n      <div>\n        <h3>Robots</h3>\n        <ul style={{ listStyleType: 'none', padding: 0 }}>\n          {robots.map((robot) => (\n            <li key={robot._id} style={{ padding: '10px', borderBottom: '1px solid #ccc' }}>\n              {robot.name} - {robot.location.x}, {robot.location.y}\n            </li>\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n}\n\nexport default MonitoringPage;\n\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,MAAM,MAAM,gCAAgC;AACnD,OAAOC,YAAY,MAAM,sCAAsC;AAC/D,OAAOC,QAAQ,MAAM,kCAAkC;AACvD,OAAOC,KAAK,MAAM,OAAO;AAEzB,SAASC,cAAcA,CAAA,EAAG;EACxB,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGP,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAM,CAACQ,MAAM,EAAEC,SAAS,CAAC,GAAGT,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAM,CAACU,EAAE,EAAEC,KAAK,CAAC,GAAGX,QAAQ,CAAC,IAAI,CAAC;EAElCD,SAAS,CAAC,MAAM;IACda,QAAQ,CAAC,CAAC;IAEV,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAML,EAAE,GAAG,IAAIM,SAAS,CAAC,+BAA+BH,KAAK,EAAE,CAAC;IAChEH,EAAE,CAACO,SAAS,GAAIC,KAAK,IAAK;MACxB,MAAMC,aAAa,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACI,IAAI,CAAC;MAC5Cb,SAAS,CAACU,aAAa,CAAC;IAC1B,CAAC;IACDR,KAAK,CAACD,EAAE,CAAC;IAET,OAAO,MAAM;MACX,IAAIA,EAAE,EAAEA,EAAE,CAACa,KAAK,CAAC,CAAC;IACpB,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMX,QAAQ,GAAG,MAAAA,CAAA,KAAY;IAC3B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAI,CAACF,KAAK,EAAE;MACVW,KAAK,CAAC,sCAAsC,CAAC;MAC7C;IACF;IAEA,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMrB,KAAK,CAACsB,GAAG,CAAC,4CAA4C,EAAE;QAC7EC,OAAO,EAAE;UACP,eAAe,EAAE,UAAUd,KAAK;QAClC,CAAC;QACDe,YAAY,EAAE;MAChB,CAAC,CAAC;MACF,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACL,QAAQ,CAACH,IAAI,CAAC,EAAE;QAAES,IAAI,EAAE;MAAY,CAAC,CAAC;MAC7D,MAAMC,GAAG,GAAGC,MAAM,CAACC,GAAG,CAACC,eAAe,CAACN,IAAI,CAAC;MAC5CtB,SAAS,CAACyB,GAAG,CAAC;IAChB,CAAC,CAAC,OAAOI,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;IAC7C;EACF,CAAC;EAED,oBACEtC,KAAA,CAAAwC,aAAA;IAAKC,KAAK,EAAE;MAAEC,UAAU,EAAE,mBAAmB;MAAEC,MAAM,EAAE;IAAO,CAAE;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAC9DjD,KAAA,CAAAwC,aAAA;IAAQC,KAAK,EAAE;MAAES,OAAO,EAAE,MAAM;MAAEC,cAAc,EAAE,eAAe;MAAEC,YAAY,EAAE;IAAO,CAAE;IAAAR,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACxFjD,KAAA,CAAAwC,aAAA,CAACnC,QAAQ;IAAAuC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CAAE,CAAC,eACZjD,KAAA,CAAAwC,aAAA,CAACpC,YAAY;IAAAwC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CAAE,CACT,CAAC,eACTjD,KAAA,CAAAwC,aAAA;IAAKC,KAAK,EAAE;MAAES,OAAO,EAAE;IAAO,CAAE;IAAAN,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAC9BjD,KAAA,CAAAwC,aAAA,CAACrC,MAAM;IAAAyC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CAAE,CACN,CAAC,eACNjD,KAAA,CAAAwC,aAAA;IAAIC,KAAK,EAAE;MAAEY,SAAS,EAAE,QAAQ;MAAEV,MAAM,EAAE;IAAS,CAAE;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAC,YAAc,CAAC,eACrEjD,KAAA,CAAAwC,aAAA;IAAKC,KAAK,EAAE;MAAEY,SAAS,EAAE,QAAQ;MAAED,YAAY,EAAE;IAAO,CAAE;IAAAR,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GACvDzC,MAAM,iBACLR,KAAA,CAAAwC,aAAA;IAAKC,KAAK,EAAE;MAAEa,QAAQ,EAAE;IAAW,CAAE;IAAAV,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACnCjD,KAAA,CAAAwC,aAAA;IAAKe,GAAG,EAAE/C,MAAO;IAACgD,GAAG,EAAC,KAAK;IAACf,KAAK,EAAE;MAAEgB,QAAQ,EAAE;IAAO,CAAE;IAAAb,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CAAE,CAAC,EAC1DvC,MAAM,CAACgD,GAAG,CAACC,KAAK,iBACf3D,KAAA,CAAAwC,aAAA;IACEoB,GAAG,EAAED,KAAK,CAACE,GAAI;IACfpB,KAAK,EAAE;MACLa,QAAQ,EAAE,UAAU;MACpBQ,IAAI,EAAE,GAAGH,KAAK,CAACI,QAAQ,CAACC,CAAC,IAAI;MAC7BC,GAAG,EAAE,GAAGN,KAAK,CAACI,QAAQ,CAACG,CAAC,IAAI;MAC5BC,KAAK,EAAE,MAAM;MACbC,MAAM,EAAE,MAAM;MACdC,eAAe,EAAE,KAAK;MACtBC,YAAY,EAAE;IAChB,CAAE;IAAA1B,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CACE,CACP,CACE,CAEJ,CAAC,eACNjD,KAAA,CAAAwC,aAAA;IAAAI,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACEjD,KAAA,CAAAwC,aAAA;IAAAI,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAI,QAAU,CAAC,eACfjD,KAAA,CAAAwC,aAAA;IAAIC,KAAK,EAAE;MAAE8B,aAAa,EAAE,MAAM;MAAEC,OAAO,EAAE;IAAE,CAAE;IAAA5B,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAC9CvC,MAAM,CAACgD,GAAG,CAAEC,KAAK,iBAChB3D,KAAA,CAAAwC,aAAA;IAAIoB,GAAG,EAAED,KAAK,CAACE,GAAI;IAACpB,KAAK,EAAE;MAAE+B,OAAO,EAAE,MAAM;MAAEC,YAAY,EAAE;IAAiB,CAAE;IAAA7B,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAC5EU,KAAK,CAACe,IAAI,EAAC,KAAG,EAACf,KAAK,CAACI,QAAQ,CAACC,CAAC,EAAC,IAAE,EAACL,KAAK,CAACI,QAAQ,CAACG,CACjD,CACL,CACC,CACD,CACF,CAAC;AAEV;AAEA,eAAe3D,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module"}
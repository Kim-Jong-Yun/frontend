{"ast":null,"code":"var _jsxFileName = \"/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Map/NoGoZone.js\";\n// src/components/MapManage/NoGoZone.js\n\nimport React, { useRef, useState } from 'react';\nimport axios from 'axios';\nimport './NoGoZone.css';\nfunction NoGoZone({\n  mapId,\n  onClose,\n  onNoGoZoneCreated\n}) {\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [startPoint, setStartPoint] = useState(null);\n  const [currentRect, setCurrentRect] = useState(null);\n\n  // 금지 구역 그리기\n  const drawRectangle = (ctx, rect, color = 'rgba(255, 0, 0, 0.3)') => {\n    if (!rect) return;\n    ctx.fillStyle = color;\n    ctx.strokeStyle = 'red';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.rect(rect.x, rect.y, rect.width, rect.height);\n    ctx.fill();\n    ctx.stroke();\n  };\n  const handleMouseDown = e => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const rect = canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    setStartPoint({\n      x,\n      y\n    });\n    setIsDrawing(true);\n  };\n  const handleMouseMove = e => {\n    if (!isDrawing || !startPoint) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const rect = canvas.getBoundingClientRect();\n    const currentX = e.clientX - rect.left;\n    const currentY = e.clientY - rect.top;\n    const width = currentX - startPoint.x;\n    const height = currentY - startPoint.y;\n    setCurrentRect({\n      x: width >= 0 ? startPoint.x : currentX,\n      y: height >= 0 ? startPoint.y : currentY,\n      width: Math.abs(width),\n      height: Math.abs(height)\n    });\n\n    // 캔버스 클리어 및 기존 사각형 그리기\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    drawRectangle(ctx, currentRect);\n    drawRectangle(ctx, {\n      x: width >= 0 ? startPoint.x : currentX,\n      y: height >= 0 ? startPoint.y : currentY,\n      width: Math.abs(width),\n      height: Math.abs(height)\n    });\n  };\n  const handleMouseUp = e => {\n    if (!isDrawing || !startPoint || !currentRect) return;\n    setIsDrawing(false);\n\n    // 금지구역 저장\n    saveNoGoZone(currentRect);\n    setStartPoint(null);\n    setCurrentRect(null);\n  };\n  const saveNoGoZone = async rect => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n\n    // 좌상단과 우하단 좌표 계산\n    const topLeft = {\n      x: rect.x,\n      y: rect.y\n    };\n    const bottomRight = {\n      x: rect.x + rect.width,\n      y: rect.y + rect.height\n    };\n    try {\n      await axios.post('http://172.30.1.30:5557/map/no-go-zones', {\n        topLeft,\n        bottomRight,\n        mapId\n      }, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      alert('금지구역이 성공적으로 생성되었습니다.');\n      onNoGoZoneCreated();\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('금지구역 생성 중 오류 발생:', error);\n      alert(`금지구역 생성 중 오류 발생: ${((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message}`);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"nogozone-popup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"nogozone-popup-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }\n  }, \"\\uAE08\\uC9C0 \\uAD6C\\uC5ED \\uC0DD\\uC131\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }, \"\\uC9C0\\uB3C4\\uB97C \\uB4DC\\uB798\\uADF8\\uD558\\uC5EC \\uAE08\\uC9C0 \\uAD6C\\uC5ED\\uC744 \\uC124\\uC815\\uD558\\uC138\\uC694.\"), /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    className: \"nogozone-canvas\",\n    onMouseDown: handleMouseDown,\n    onMouseMove: handleMouseMove,\n    onMouseUp: handleMouseUp,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: onClose,\n    className: \"nogozone-close-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, \"\\uB2EB\\uAE30\")));\n}\nexport default NoGoZone;","map":{"version":3,"names":["React","useRef","useState","axios","NoGoZone","mapId","onClose","onNoGoZoneCreated","canvasRef","isDrawing","setIsDrawing","startPoint","setStartPoint","currentRect","setCurrentRect","drawRectangle","ctx","rect","color","fillStyle","strokeStyle","lineWidth","beginPath","x","y","width","height","fill","stroke","handleMouseDown","e","canvas","current","getBoundingClientRect","clientX","left","clientY","top","handleMouseMove","getContext","currentX","currentY","Math","abs","clearRect","handleMouseUp","saveNoGoZone","token","localStorage","getItem","alert","topLeft","bottomRight","post","headers","error","_error$response","_error$response$data","console","response","data","message","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","onMouseDown","onMouseMove","onMouseUp","onClick"],"sources":["/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Map/NoGoZone.js"],"sourcesContent":["// src/components/MapManage/NoGoZone.js\n\nimport React, { useRef, useState } from 'react';\nimport axios from 'axios';\nimport './NoGoZone.css';\n\nfunction NoGoZone({ mapId, onClose, onNoGoZoneCreated }) {\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [startPoint, setStartPoint] = useState(null);\n  const [currentRect, setCurrentRect] = useState(null);\n\n  // 금지 구역 그리기\n  const drawRectangle = (ctx, rect, color = 'rgba(255, 0, 0, 0.3)') => {\n    if (!rect) return;\n    ctx.fillStyle = color;\n    ctx.strokeStyle = 'red';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.rect(rect.x, rect.y, rect.width, rect.height);\n    ctx.fill();\n    ctx.stroke();\n  };\n\n  const handleMouseDown = (e) => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const rect = canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    setStartPoint({ x, y });\n    setIsDrawing(true);\n  };\n\n  const handleMouseMove = (e) => {\n    if (!isDrawing || !startPoint) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const rect = canvas.getBoundingClientRect();\n    const currentX = e.clientX - rect.left;\n    const currentY = e.clientY - rect.top;\n\n    const width = currentX - startPoint.x;\n    const height = currentY - startPoint.y;\n\n    setCurrentRect({\n      x: width >= 0 ? startPoint.x : currentX,\n      y: height >= 0 ? startPoint.y : currentY,\n      width: Math.abs(width),\n      height: Math.abs(height),\n    });\n\n    // 캔버스 클리어 및 기존 사각형 그리기\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    drawRectangle(ctx, currentRect);\n    drawRectangle(ctx, {\n      x: width >= 0 ? startPoint.x : currentX,\n      y: height >= 0 ? startPoint.y : currentY,\n      width: Math.abs(width),\n      height: Math.abs(height),\n    });\n  };\n\n  const handleMouseUp = (e) => {\n    if (!isDrawing || !startPoint || !currentRect) return;\n    setIsDrawing(false);\n\n    // 금지구역 저장\n    saveNoGoZone(currentRect);\n\n    setStartPoint(null);\n    setCurrentRect(null);\n  };\n\n  const saveNoGoZone = async (rect) => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n\n    // 좌상단과 우하단 좌표 계산\n    const topLeft = { x: rect.x, y: rect.y };\n    const bottomRight = { x: rect.x + rect.width, y: rect.y + rect.height };\n\n    try {\n      await axios.post('http://172.30.1.30:5557/map/no-go-zones', {\n        topLeft,\n        bottomRight,\n        mapId,\n      }, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json',\n        },\n      });\n      alert('금지구역이 성공적으로 생성되었습니다.');\n      onNoGoZoneCreated();\n    } catch (error) {\n      console.error('금지구역 생성 중 오류 발생:', error);\n      alert(`금지구역 생성 중 오류 발생: ${error.response?.data?.message || error.message}`);\n    }\n  };\n\n  return (\n    <div className=\"nogozone-popup\">\n      <div className=\"nogozone-popup-content\">\n        <h3>금지 구역 생성</h3>\n        <p>지도를 드래그하여 금지 구역을 설정하세요.</p>\n        <canvas\n          ref={canvasRef}\n          className=\"nogozone-canvas\"\n          onMouseDown={handleMouseDown}\n          onMouseMove={handleMouseMove}\n          onMouseUp={handleMouseUp}\n        />\n        <button onClick={onClose} className=\"nogozone-close-button\">\n          닫기\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default NoGoZone;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}
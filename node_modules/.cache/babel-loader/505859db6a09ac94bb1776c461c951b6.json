{"ast":null,"code":"var _jsxFileName = \"/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Test/MapComponent.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nfunction MapComponent() {\n  const [mapUrl, setMapUrl] = useState(null);\n  const canvasRef = useRef(null);\n  useEffect(() => {\n    fetchMonitoredMap();\n  }, []);\n  const getToken = () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      window.location.href = '/login'; // 토큰이 없으면 로그인 페이지로 리디렉션\n      return null;\n    }\n    return token;\n  };\n  const fetchMonitoredMap = async () => {\n    const token = getToken();\n    if (!token) return;\n    try {\n      const response = await axios.get('http://172.30.1.28:5557/map/monitored/file', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        },\n        responseType: 'blob'\n      });\n      const url = URL.createObjectURL(response.data);\n      setMapUrl(url);\n      const img = new Image();\n      img.src = url;\n      img.onload = () => {\n        const canvas = canvasRef.current;\n        if (canvas) {\n          const ctx = canvas.getContext('2d');\n          // 캔버스 크기 설정\n          canvas.width = img.width;\n          canvas.height = img.height;\n          // 이미지 그리기\n          ctx.drawImage(img, 0, 0, img.width, img.height);\n        }\n      };\n      img.onerror = err => {\n        console.error('지도 이미지를 로드하는 중 오류 발생:', err);\n      };\n    } catch (error) {\n      console.error('모니터링 지도 가져오기 오류:', error);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '800px',\n      // 고정된 너비\n      height: '600px',\n      // 고정된 높이\n      overflow: 'auto',\n      // 넘치면 스크롤\n      border: '1px solid #ccc',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }\n  }, mapUrl ? /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    style: {\n      border: '1px solid #ccc'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }, \"\\uC9C0\\uB3C4\\uB97C \\uBD88\\uB7EC\\uC624\\uB294 \\uC911...\"));\n}\nexport default MapComponent;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","MapComponent","mapUrl","setMapUrl","canvasRef","fetchMonitoredMap","getToken","token","localStorage","getItem","alert","window","location","href","response","get","headers","Authorization","responseType","url","URL","createObjectURL","data","img","Image","src","onload","canvas","current","ctx","getContext","width","height","drawImage","onerror","err","console","error","createElement","style","overflow","border","display","justifyContent","alignItems","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref"],"sources":["/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Test/MapComponent.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\n\nfunction MapComponent() {\n  const [mapUrl, setMapUrl] = useState(null);\n  const canvasRef = useRef(null);\n\n  useEffect(() => {\n    fetchMonitoredMap();\n  }, []);\n\n  const getToken = () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      window.location.href = '/login'; // 토큰이 없으면 로그인 페이지로 리디렉션\n      return null;\n    }\n    return token;\n  };\n\n  const fetchMonitoredMap = async () => {\n    const token = getToken();\n    if (!token) return;\n\n    try {\n      const response = await axios.get('http://172.30.1.28:5557/map/monitored/file', {\n        headers: { Authorization: `Bearer ${token}` },\n        responseType: 'blob',\n      });\n\n      const url = URL.createObjectURL(response.data);\n      setMapUrl(url);\n\n      const img = new Image();\n      img.src = url;\n      img.onload = () => {\n        const canvas = canvasRef.current;\n        if (canvas) {\n          const ctx = canvas.getContext('2d');\n          // 캔버스 크기 설정\n          canvas.width = img.width;\n          canvas.height = img.height;\n          // 이미지 그리기\n          ctx.drawImage(img, 0, 0, img.width, img.height);\n        }\n      };\n      img.onerror = (err) => {\n        console.error('지도 이미지를 로드하는 중 오류 발생:', err);\n      };\n    } catch (error) {\n      console.error('모니터링 지도 가져오기 오류:', error);\n    }\n  };\n\n  return (\n    <div style={{\n      width: '800px',  // 고정된 너비\n      height: '600px', // 고정된 높이\n      overflow: 'auto',   // 넘치면 스크롤\n      border: '1px solid #ccc', \n      display: 'flex', \n      justifyContent: 'center', \n      alignItems: 'center'\n    }}>\n      {mapUrl ? (\n        <canvas ref={canvasRef} style={{ border: '1px solid #ccc' }}></canvas>\n      ) : (\n        <p>지도를 불러오는 중...</p>\n      )}\n    </div>\n  );\n}\n\nexport default MapComponent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}
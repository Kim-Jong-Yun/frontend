{"ast":null,"code":"var _jsxFileName = \"/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Map/NoGoZone.js\";\n// src/components/MapManage/NoGoZone.js\n\nimport React, { useRef, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport './NoGoZone.css';\nfunction NoGoZone({\n  mapId,\n  onClose,\n  onNoGoZoneCreated,\n  onNoGoZoneDeleted,\n  isDeleting\n}) {\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [startPoint, setStartPoint] = useState(null);\n  const [currentRect, setCurrentRect] = useState(null);\n  const [noGoZones, setNoGoZones] = useState([]); // 금지 구역 목록\n  const [hoveredZoneId, setHoveredZoneId] = useState(null);\n  useEffect(() => {\n    if (mapId) fetchNoGoZones();\n  }, [mapId]);\n  const fetchNoGoZones = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get(`http://172.30.1.30:5557/map/no-go-zones/map/${mapId}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setNoGoZones(response.data);\n    } catch (error) {\n      console.error('금지구역 목록 가져오기 실패:', error);\n    }\n  };\n  const drawRectangle = (ctx, rect, color = 'rgba(255, 0, 0, 0.3)', isHovered = false) => {\n    if (!rect) return;\n    ctx.fillStyle = color;\n    ctx.strokeStyle = 'red';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.rect(rect.x, rect.y, rect.width, rect.height);\n    ctx.fill();\n    ctx.stroke();\n    if (isHovered && isDeleting) {\n      ctx.fillStyle = 'rgba(255, 0, 0, 0.7)';\n      ctx.font = '16px Arial';\n      ctx.fillText('X', rect.x + rect.width - 15, rect.y + 20);\n    }\n  };\n  const handleMouseMove = e => {\n    if (!canvasRef.current || !isDeleting) return;\n    const rect = canvasRef.current.getBoundingClientRect();\n    const mouseX = e.clientX - rect.left;\n    const mouseY = e.clientY - rect.top;\n    let hoveredZone = null;\n    noGoZones.forEach(zone => {\n      const {\n        x,\n        y,\n        width,\n        height\n      } = zone;\n      if (mouseX >= x && mouseX <= x + width && mouseY >= y && mouseY <= y + height) {\n        hoveredZone = zone;\n      }\n    });\n    setHoveredZoneId(hoveredZone ? hoveredZone._id : null);\n    redrawCanvas();\n  };\n  const handleMouseClick = async () => {\n    if (isDeleting && hoveredZoneId) {\n      try {\n        const token = localStorage.getItem('token');\n        await axios.delete(`http://172.30.1.30:5557/map/no-go-zones/${hoveredZoneId}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        alert('금지 구역이 성공적으로 삭제되었습니다.');\n        onNoGoZoneDeleted();\n      } catch (error) {\n        console.error('금지 구역 삭제 실패:', error);\n      }\n    }\n  };\n  const redrawCanvas = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    noGoZones.forEach(zone => {\n      const isHovered = zone._id === hoveredZoneId;\n      drawRectangle(ctx, zone, 'rgba(255, 0, 0, 0.3)', isHovered);\n    });\n  };\n  useEffect(() => {\n    if (canvasRef.current) {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      canvas.width = canvas.offsetWidth;\n      canvas.height = canvas.offsetHeight;\n      redrawCanvas();\n    }\n  }, [noGoZones, hoveredZoneId]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"nogozone-popup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"nogozone-popup-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }\n  }, \"\\uAE08\\uC9C0 \\uAD6C\\uC5ED \\uC124\\uC815\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }, \"\\uAE08\\uC9C0 \\uAD6C\\uC5ED\\uC744 \\uC124\\uC815\\uD558\\uAC70\\uB098 \\uC0AD\\uC81C\\uD558\\uB824\\uBA74 \\uC9C0\\uB3C4\\uC5D0\\uC11C \\uC601\\uC5ED\\uC744 \\uC120\\uD0DD\\uD558\\uC138\\uC694.\"), /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    className: \"nogozone-canvas\",\n    onMouseMove: handleMouseMove,\n    onClick: handleMouseClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: onClose,\n    className: \"nogozone-close-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, \"\\uB2EB\\uAE30\")));\n}\nexport default NoGoZone;","map":{"version":3,"names":["React","useRef","useState","useEffect","axios","NoGoZone","mapId","onClose","onNoGoZoneCreated","onNoGoZoneDeleted","isDeleting","canvasRef","isDrawing","setIsDrawing","startPoint","setStartPoint","currentRect","setCurrentRect","noGoZones","setNoGoZones","hoveredZoneId","setHoveredZoneId","fetchNoGoZones","token","localStorage","getItem","response","get","headers","Authorization","data","error","console","drawRectangle","ctx","rect","color","isHovered","fillStyle","strokeStyle","lineWidth","beginPath","x","y","width","height","fill","stroke","font","fillText","handleMouseMove","e","current","getBoundingClientRect","mouseX","clientX","left","mouseY","clientY","top","hoveredZone","forEach","zone","_id","redrawCanvas","handleMouseClick","delete","alert","canvas","getContext","clearRect","offsetWidth","offsetHeight","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","onMouseMove","onClick"],"sources":["/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Map/NoGoZone.js"],"sourcesContent":["// src/components/MapManage/NoGoZone.js\n\nimport React, { useRef, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport './NoGoZone.css';\n\nfunction NoGoZone({ mapId, onClose, onNoGoZoneCreated, onNoGoZoneDeleted, isDeleting }) {\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [startPoint, setStartPoint] = useState(null);\n  const [currentRect, setCurrentRect] = useState(null);\n  const [noGoZones, setNoGoZones] = useState([]); // 금지 구역 목록\n  const [hoveredZoneId, setHoveredZoneId] = useState(null);\n\n  useEffect(() => {\n    if (mapId) fetchNoGoZones();\n  }, [mapId]);\n\n  const fetchNoGoZones = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get(`http://172.30.1.30:5557/map/no-go-zones/map/${mapId}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      setNoGoZones(response.data);\n    } catch (error) {\n      console.error('금지구역 목록 가져오기 실패:', error);\n    }\n  };\n\n  const drawRectangle = (ctx, rect, color = 'rgba(255, 0, 0, 0.3)', isHovered = false) => {\n    if (!rect) return;\n    ctx.fillStyle = color;\n    ctx.strokeStyle = 'red';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.rect(rect.x, rect.y, rect.width, rect.height);\n    ctx.fill();\n    ctx.stroke();\n    \n    if (isHovered && isDeleting) {\n      ctx.fillStyle = 'rgba(255, 0, 0, 0.7)';\n      ctx.font = '16px Arial';\n      ctx.fillText('X', rect.x + rect.width - 15, rect.y + 20);\n    }\n  };\n\n  const handleMouseMove = (e) => {\n    if (!canvasRef.current || !isDeleting) return;\n    const rect = canvasRef.current.getBoundingClientRect();\n    const mouseX = e.clientX - rect.left;\n    const mouseY = e.clientY - rect.top;\n\n    let hoveredZone = null;\n    noGoZones.forEach((zone) => {\n      const { x, y, width, height } = zone;\n      if (\n        mouseX >= x &&\n        mouseX <= x + width &&\n        mouseY >= y &&\n        mouseY <= y + height\n      ) {\n        hoveredZone = zone;\n      }\n    });\n    setHoveredZoneId(hoveredZone ? hoveredZone._id : null);\n    redrawCanvas();\n  };\n\n  const handleMouseClick = async () => {\n    if (isDeleting && hoveredZoneId) {\n      try {\n        const token = localStorage.getItem('token');\n        await axios.delete(`http://172.30.1.30:5557/map/no-go-zones/${hoveredZoneId}`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        alert('금지 구역이 성공적으로 삭제되었습니다.');\n        onNoGoZoneDeleted();\n      } catch (error) {\n        console.error('금지 구역 삭제 실패:', error);\n      }\n    }\n  };\n\n  const redrawCanvas = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    noGoZones.forEach((zone) => {\n      const isHovered = zone._id === hoveredZoneId;\n      drawRectangle(ctx, zone, 'rgba(255, 0, 0, 0.3)', isHovered);\n    });\n  };\n\n  useEffect(() => {\n    if (canvasRef.current) {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      canvas.width = canvas.offsetWidth;\n      canvas.height = canvas.offsetHeight;\n      redrawCanvas();\n    }\n  }, [noGoZones, hoveredZoneId]);\n\n  return (\n    <div className=\"nogozone-popup\">\n      <div className=\"nogozone-popup-content\">\n        <h3>금지 구역 설정</h3>\n        <p>금지 구역을 설정하거나 삭제하려면 지도에서 영역을 선택하세요.</p>\n        <canvas\n          ref={canvasRef}\n          className=\"nogozone-canvas\"\n          onMouseMove={handleMouseMove}\n          onClick={handleMouseClick}\n        />\n        <button onClick={onClose} className=\"nogozone-close-button\">\n          닫기\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default NoGoZone;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}
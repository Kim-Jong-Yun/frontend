{"ast":null,"code":"var _jsxFileName = \"/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Map/Mapmanage.js\";\n// src/components/MapManage/Mapmanage.js\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEdit, faPlus, faLink, faUnlink } from '@fortawesome/free-solid-svg-icons';\nimport Navbar from '../../components/Common/Navbar';\nimport LogoutButton from '../../components/Common/LogoutButton';\nimport UserInfo from '../../components/Common/UserInfo';\nimport './Mapmanage.css';\nimport { worldToMap, mapToWorld } from '../../utils/coordinateUtils';\nimport NodeList from './NodeList'; // NodeList 컴포넌트 임포트\nimport NodeDisconnect from './NodeDisconnect'; // NodeDisconnect 컴포넌트 임포트\nimport NoGoZone from './NoGoZone'; // NoGoZone 컴포넌트 임포트\n\nfunction Mapmanage() {\n  const [maps, setMaps] = useState([]);\n  const [selectedMap, setSelectedMap] = useState(null); // 선택된 맵 상태\n  const [editName, setEditName] = useState('');\n  const [editDescription, setEditDescription] = useState('');\n  const [isMonitored, setIsMonitored] = useState(false); // 모니터링 설정 체크박스 상태\n  const [uploadName, setUploadName] = useState('');\n  const [uploadDescription, setUploadDescription] = useState('');\n  const [mapFile, setMapFile] = useState(null);\n  const [yamlFile, setYamlFile] = useState(null);\n  const [mapImage, setMapImage] = useState(null);\n  const [isUploadPopupOpen, setIsUploadPopupOpen] = useState(false); // 업로드 팝업 상태\n  const [isEditPopupOpen, setIsEditPopupOpen] = useState(false); // 수정 팝업 상태\n  const [isCreatingNode, setIsCreatingNode] = useState(false); // 노드 생성 모드\n  const [nodeX, setNodeX] = useState(null); // X 좌표\n  const [nodeY, setNodeY] = useState(null); // Y 좌표\n  const [nodeName, setNodeName] = useState(''); // 노드 이름\n  const [isNodePopupOpen, setIsNodePopupOpen] = useState(false); // 노드 팝업 상태\n  const canvasRef = useRef(null); // 캔버스 참조\n  const mapImageRef = useRef(null); // 지도 이미지 참조\n  const [nodes, setNodes] = useState([]); // 노드 목록 저장\n  const [isDeletingNode, setIsDeletingNode] = useState(false);\n  const [imageNaturalWidth, setImageNaturalWidth] = useState(null);\n  const [imageNaturalHeight, setImageNaturalHeight] = useState(null);\n\n  // Hover 상태 관리\n  const [hoveredNode, setHoveredNode] = useState(null);\n  const [tooltipPosition, setTooltipPosition] = useState({\n    x: 0,\n    y: 0\n  });\n\n  // 연결 단계 관리\n  const [connectionStep, setConnectionStep] = useState('idle'); // 'idle', 'selectingFirstNode', 'selectingWaypoints', 'selectingSecondNode'\n  const [waypointCount, setWaypointCount] = useState(0); // 웨이포인트 개수\n  const [currentWaypoint, setCurrentWaypoint] = useState(0); // 현재 웨이포인트 수\n  const [waypoints, setWaypoints] = useState([]); // 웨이포인트 배열\n  const [firstNodeId, setFirstNodeId] = useState(null); // 첫 번째 노드 ID\n\n  // 연결 해제 단계 관리\n  const [disconnectStep, setDisconnectStep] = useState('idle'); // 'idle', 'selectingFirstNode', 'selectingSecondNode'\n  const [disconnectFirstNodeId, setDisconnectFirstNodeId] = useState(null);\n  const [disconnectSecondNodeId, setDisconnectSecondNodeId] = useState(null);\n\n  // 금지구역 관련 상태\n  const [isCreatingNoGoZone, setIsCreatingNoGoZone] = useState(false);\n  const [noGoZones, setNoGoZones] = useState([]);\n\n  // 맵 목록을 서버에서 가져오는 함수\n  const fetchMaps = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n    try {\n      const response = await axios.get('http://172.30.1.30:5557/map/maps', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setMaps(response.data);\n\n      // 맵이 하나 이상 있을 경우 첫 번째 맵을 자동으로 선택\n      if (response.data.length > 0) {\n        await handleSelectMap(response.data[0]);\n      }\n    } catch (error) {\n      console.error('맵을 가져오는 중 오류 발생:', error);\n      alert('맵을 가져오는 데 실패했습니다.');\n    }\n  };\n  useEffect(() => {\n    fetchMaps();\n  }, []);\n\n  // 노드 목록을 서버에서 가져오는 함수\n  const fetchNodes = async mapId => {\n    try {\n      const response = await axios.get(`http://172.30.1.30:5557/map/nodes/${mapId}`);\n      if (response.status === 200) {\n        setNodes(response.data); // 노드 리스트 상태 업데이트\n      } else {\n        setNodes([]); // 실패 시 빈 배열로 초기화\n      }\n    } catch (error) {\n      console.error('노드를 가져오는 중 오류 발생:', error);\n      setNodes([]); // 오류 발생 시에도 빈 배열로 초기화\n      alert('노드를 가져오는 데 실패했습니다.');\n    }\n  };\n\n  // 금지구역 목록을 서버에서 가져오는 함수\n  const fetchNoGoZones = async mapId => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n    try {\n      const response = await axios.get(`http://172.30.1.30:5557/api/no-go-zones/map/${mapId}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setNoGoZones(response.data);\n    } catch (error) {\n      console.error('금지구역을 가져오는 중 오류 발생:', error);\n      alert('금지구역을 가져오는 데 실패했습니다.');\n    }\n  };\n\n  // 맵을 선택했을 때 호출되는 함수\n  const handleSelectMap = async map => {\n    setSelectedMap(map); // 맵 선택 상태 업데이트\n    setEditName(map.name);\n    setEditDescription(map.description);\n    setIsMonitored(map.isMonitored || false); // 모니터링 지도 상태 설정\n\n    // 맵 이미지 가져오기\n    const token = localStorage.getItem('token');\n    try {\n      const response = await axios.get(`http://172.30.1.30:5557/map/file/${map._id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        },\n        responseType: 'blob'\n      });\n      const imageUrl = URL.createObjectURL(response.data);\n      setMapImage(imageUrl); // 이미지 설정\n    } catch (error) {\n      console.error('맵 이미지를 가져오는 중 오류 발생:', error);\n      alert('맵 이미지를 가져오는 데 실패했습니다.');\n    }\n\n    // 금지구역 가져오기\n    await fetchNoGoZones(map._id);\n  };\n\n  // 이미지 로드 시 호출되는 함수 (지도 이미지를 캔버스에 그리기)\n  const loadMapImage = () => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    mapImageRef.current = new Image();\n    mapImageRef.current.src = mapImage;\n    mapImageRef.current.onload = () => {\n      const imgWidth = mapImageRef.current.width;\n      const imgHeight = mapImageRef.current.height;\n      setImageNaturalWidth(imgWidth);\n      setImageNaturalHeight(imgHeight);\n\n      // 캔버스 크기 조정 및 기존 내용 클리어\n      canvas.width = imgWidth;\n      canvas.height = imgHeight;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      // 지도 이미지를 캔버스에 그리기\n      ctx.drawImage(mapImageRef.current, 0, 0, imgWidth, imgHeight);\n      drawNodes(); // 노드 그리기\n    };\n  };\n\n  // 맵 좌표계를 캔버스 좌표계로 변환하는 함수\n  const mapToMapCoordinates = (x, y) => {\n    return worldToMap(x, y, imageNaturalWidth, imageNaturalHeight);\n  };\n\n  // 노드를 캔버스에 그리는 함수\n  const drawNodes = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    if (!canvas || !imageNaturalWidth || !imageNaturalHeight) return;\n\n    // 기존 노드 그리기 전에 캔버스를 클리어\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // 지도 이미지 다시 그리기\n    ctx.drawImage(mapImageRef.current, 0, 0, imageNaturalWidth, imageNaturalHeight);\n\n    // 금지구역 그리기\n    noGoZones.forEach(zone => {\n      const topLeft = mapToMapCoordinates(zone.topLeft.x, zone.topLeft.y);\n      const bottomRight = mapToMapCoordinates(zone.bottomRight.x, zone.bottomRight.y);\n      const width = bottomRight.x - topLeft.x;\n      const height = bottomRight.y - topLeft.y;\n      ctx.fillStyle = 'rgba(255, 0, 0, 0.3)';\n      ctx.fillRect(topLeft.x, topLeft.y, width, height);\n      ctx.strokeStyle = 'red';\n      ctx.lineWidth = 2;\n      ctx.strokeRect(topLeft.x, topLeft.y, width, height);\n    });\n\n    // 연결선을 먼저 그리기\n    nodes.forEach(node => {\n      node.connections.forEach(connection => {\n        const connectedNode = nodes.find(n => n._id === connection.node);\n        if (connectedNode) {\n          const {\n            x: startX,\n            y: startY\n          } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const {\n            x: endX,\n            y: endY\n          } = worldToMap(connectedNode.x, connectedNode.y, imageNaturalWidth, imageNaturalHeight);\n          ctx.strokeStyle = 'blue';\n          ctx.lineWidth = 2;\n          ctx.beginPath();\n          ctx.moveTo(startX, startY);\n\n          // 웨이포인트가 있는 경우\n          if (connection.waypoints && connection.waypoints.length > 0) {\n            connection.waypoints.forEach(wp => {\n              const {\n                x: wpX,\n                y: wpY\n              } = worldToMap(wp.x, wp.y, imageNaturalWidth, imageNaturalHeight);\n              ctx.lineTo(wpX, wpY);\n            });\n          }\n          ctx.lineTo(endX, endY);\n          ctx.stroke();\n        }\n      });\n    });\n\n    // 노드 그리기\n    nodes.forEach(node => {\n      const {\n        x,\n        y\n      } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n      const size = 10;\n      ctx.fillStyle = 'red';\n      ctx.fillRect(x - size / 2, y - size / 2, size, size);\n    });\n  };\n\n  // 이미지 로드 후 캔버스에 지도 그리기\n  useEffect(() => {\n    if (mapImage) {\n      loadMapImage();\n    }\n  }, [mapImage]);\n\n  // 맵 이미지와 selectedMap이 모두 설정된 후 노드 패치\n  useEffect(() => {\n    if (mapImage && selectedMap) {\n      fetchNodes(selectedMap._id);\n    }\n  }, [mapImage, selectedMap]);\n\n  // 노드 변경 시마다 노드를 다시 그리기\n  useEffect(() => {\n    if (canvasRef.current && mapImageRef.current) {\n      drawNodes(); // 노드를 다시 그리기\n    }\n  }, [nodes, noGoZones]);\n\n  // 금지구역 변경 시마다 노드를 다시 그리기\n  useEffect(() => {\n    if (canvasRef.current && mapImageRef.current) {\n      drawNodes(); // 금지구역이 변경되면 노드와 함께 다시 그리기\n    }\n  }, [noGoZones]);\n\n  // 노드 삭제 시 커서 복구\n  useEffect(() => {\n    if (!isDeletingNode && !connectionStep.startsWith('selecting') && !disconnectStep.startsWith('selecting')) {\n      document.body.style.cursor = 'default'; // 삭제 모드 및 연결 모드가 아닐 때 커서를 기본으로 복구\n    }\n  }, [isDeletingNode, connectionStep, disconnectStep]);\n\n  // 맵을 선택했을 때 노드 및 금지구역을 그리기 위해 fetchNodes와 fetchNoGoZones를 호출 후 drawNodes를 호출할 필요가 있음\n\n  // 마우스가 캔버스 위를 움직일 때 노드 호버 상태 업데이트\n  const handleMouseMove = e => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const rect = canvas.getBoundingClientRect();\n    const mouseX = e.clientX - rect.left;\n    const mouseY = e.clientY - rect.top;\n    let foundNode = null;\n    for (let node of nodes) {\n      const {\n        x,\n        y\n      } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n      const distance = Math.sqrt((mouseX - x) ** 2 + (mouseY - y) ** 2);\n      if (distance < 5) {\n        // 노드 반경 5px 내에 있을 때\n        foundNode = node;\n        break;\n      }\n    }\n    if (foundNode) {\n      setHoveredNode(foundNode);\n      setTooltipPosition({\n        x: e.clientX,\n        y: e.clientY\n      });\n    } else {\n      setHoveredNode(null);\n    }\n  };\n\n  // 마우스가 캔버스를 벗어났을 때 호버 상태 초기화\n  const handleMouseLeave = () => {\n    setHoveredNode(null);\n  };\n\n  // 연결 모드 활성화 함수 (웨이포인트 추가 프로세스 시작)\n  const handleConnectNodeMode = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    const count = parseInt(prompt('추가할 웨이포인트의 개수를 입력하세요:', '0'), 10);\n    if (isNaN(count) || count < 0) {\n      alert('유효한 숫자를 입력해주세요.');\n      return;\n    }\n    setWaypointCount(count);\n    if (count > 0) {\n      setConnectionStep('selectingFirstNode');\n      setWaypoints([]);\n      setCurrentWaypoint(0);\n      alert('첫 번째 노드를 선택하세요.');\n      document.body.style.cursor = 'pointer'; // 연결 모드 커서로 변경\n    } else {\n      setConnectionStep('selectingFirstNode');\n      setWaypoints([]);\n      setCurrentWaypoint(0);\n      alert('첫 번째 노드를 선택하세요.');\n      document.body.style.cursor = 'pointer'; // 연결 모드 커서로 변경\n    }\n  };\n\n  // 연결 해제 모드 활성화 함수\n  const handleDisconnectNodeMode = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    setDisconnectStep('selectingFirstNode');\n    setDisconnectFirstNodeId(null);\n    setDisconnectSecondNodeId(null);\n    alert('연결을 해제할 첫 번째 노드를 선택하세요.');\n    document.body.style.cursor = 'pointer'; // 연결 해제 모드 커서로 변경\n  };\n\n  // 금지구역 생성 모드 활성화 함수\n  const handleCreateNoGoZone = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    setIsCreatingNoGoZone(true);\n  };\n\n  // 맵 이미지 클릭 시 노드 생성, 삭제, 연결 또는 웨이포인트 추가, 연결 해제\n  const handleMapClick = async e => {\n    if (!selectedMap) return;\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const rect = canvas.getBoundingClientRect();\n    const clickX = e.clientX - rect.left;\n    const clickY = e.clientY - rect.top;\n    const {\n      x,\n      y\n    } = mapToWorld(clickX, clickY, imageNaturalWidth, imageNaturalHeight);\n    try {\n      // 연결 해제 모드 처리\n      if (disconnectStep === 'selectingFirstNode') {\n        // 첫 번째 노드 선택\n        let clickedNode = null;\n        for (let node of nodes) {\n          const {\n            x: nodeX,\n            y: nodeY\n          } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            clickedNode = node;\n            break;\n          }\n        }\n        if (clickedNode) {\n          setDisconnectFirstNodeId(clickedNode._id);\n          setDisconnectStep('selectingSecondNode');\n          alert('연결을 해제할 두 번째 노드를 선택하세요.');\n        } else {\n          alert('유효한 노드를 클릭해주세요.');\n        }\n        return; // 연결 해제 모드일 때 다른 모드 처리하지 않도록 return\n      }\n      if (disconnectStep === 'selectingSecondNode') {\n        // 두 번째 노드 선택 및 연결 해제\n        let clickedNode = null;\n        for (let node of nodes) {\n          const {\n            x: nodeX,\n            y: nodeY\n          } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            clickedNode = node;\n            break;\n          }\n        }\n        if (clickedNode) {\n          if (clickedNode._id === disconnectFirstNodeId) {\n            alert('같은 노드를 선택했습니다. 다른 노드를 선택해주세요.');\n            return;\n          }\n          setDisconnectSecondNodeId(clickedNode._id);\n          setDisconnectStep('idle');\n          document.body.style.cursor = 'default'; // 커서 복구\n        } else {\n          alert('유효한 노드를 클릭해주세요.');\n        }\n        return; // 연결 해제 모드일 때 다른 모드 처리하지 않도록 return\n      }\n\n      // 기존 연결 및 노드 생성, 삭제 모드 처리\n      if (connectionStep === 'selectingFirstNode') {\n        // 첫 번째 노드 선택\n        let clickedNode = null;\n        for (let node of nodes) {\n          const {\n            x: nodeX,\n            y: nodeY\n          } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            clickedNode = node;\n            break;\n          }\n        }\n        if (clickedNode) {\n          setFirstNodeId(clickedNode._id);\n          if (waypointCount > 0) {\n            setConnectionStep('selectingWaypoints');\n            alert(`${waypointCount}개의 웨이포인트를 선택하세요.`);\n            document.body.style.cursor = 'crosshair'; // 웨이포인트 추가 모드 커서로 변경\n          } else {\n            setConnectionStep('selectingSecondNode');\n            alert('두 번째 노드를 선택하세요.');\n          }\n        } else {\n          alert('유효한 노드를 클릭해주세요.');\n        }\n      } else if (connectionStep === 'selectingWaypoints') {\n        // 웨이포인트 추가\n        const newWaypoint = {\n          x,\n          y\n        };\n        setWaypoints([...waypoints, newWaypoint]);\n        setCurrentWaypoint(currentWaypoint + 1);\n        if (currentWaypoint + 1 === waypointCount) {\n          setConnectionStep('selectingSecondNode');\n          alert('두 번째 노드를 선택하세요.');\n          document.body.style.cursor = 'pointer'; // 연결 모드 커서로 변경\n        } else {\n          alert(`${currentWaypoint + 1}/${waypointCount} 웨이포인트가 추가되었습니다.`);\n        }\n      } else if (connectionStep === 'selectingSecondNode') {\n        // 두 번째 노드 선택\n        let clickedNode = null;\n        for (let node of nodes) {\n          const {\n            x: nodeX,\n            y: nodeY\n          } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            clickedNode = node;\n            break;\n          }\n        }\n        if (clickedNode) {\n          if (clickedNode._id === firstNodeId) {\n            alert('같은 노드를 선택했습니다. 다른 노드를 선택해주세요.');\n            return;\n          }\n          try {\n            // 웨이포인트 포함 총 거리 계산\n            const totalDistance = calculateTotalDistance(firstNodeId, clickedNode._id, waypoints);\n\n            // API 요청: 연결 및 거리 정보 포함\n            const token = localStorage.getItem('token');\n            await axios.post(`http://172.30.1.30:5557/map/node/connect`, {\n              node1: firstNodeId,\n              node2: clickedNode._id,\n              waypoints: waypoints,\n              distance: totalDistance // 거리 값 추가\n            }, {\n              headers: {\n                Authorization: `Bearer ${token}`\n              }\n            });\n            alert(`노드가 성공적으로 연결되었습니다. 전체 꺾인 경로의 가중치: ${totalDistance.toFixed(2)}`);\n\n            // 연결 생성 후 상태 초기화\n            setConnectionStep('idle');\n            setFirstNodeId(null);\n            setWaypoints([]);\n            setWaypointCount(0);\n            setCurrentWaypoint(0);\n            document.body.style.cursor = 'default'; // 커서 복구\n            await fetchNodes(selectedMap._id); // 노드 목록 갱신\n            drawNodes(); // 노드 및 간선 다시 그리기\n          } catch (error) {\n            console.error('노드 연결 중 오류 발생:', error);\n            alert('노드 연결에 실패했습니다.');\n          }\n        } else {\n          alert('유효한 노드를 클릭해주세요.');\n        }\n      } else if (isCreatingNode) {\n        // 노드 생성 로직\n        setNodeX(x);\n        setNodeY(y);\n        setIsCreatingNode(false);\n        setIsNodePopupOpen(true);\n        document.body.style.cursor = 'default';\n      } else if (isDeletingNode) {\n        // 클릭한 위치 근처에 있는 노드를 찾아 삭제\n        let nodeToDelete = null;\n        for (let node of nodes) {\n          const {\n            x: nodeX,\n            y: nodeY\n          } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            nodeToDelete = node;\n            break;\n          }\n        }\n        if (nodeToDelete) {\n          const confirmDelete = window.confirm(`노드 \"${nodeToDelete.name}\"를 삭제하시겠습니까?`);\n          if (confirmDelete) {\n            try {\n              const token = localStorage.getItem('token');\n              await axios.put(`http://172.30.1.30:5557/map/node/${nodeToDelete._id}`, {}, {\n                // 두 번째 인자를 빈 객체로 전달\n                headers: {\n                  Authorization: `Bearer ${token}`\n                }\n              });\n              alert('노드가 성공적으로 삭제되었습니다.');\n\n              // 노드 목록을 다시 패치하고, 노드를 다시 그리기\n              await fetchNodes(selectedMap._id);\n              drawNodes(); // 삭제 후 노드를 다시 그리기\n\n              setIsDeletingNode(false); // 삭제 후 삭제 모드 종료\n            } catch (error) {\n              console.error('노드 삭제 중 오류 발생:', error);\n              alert('노드 삭제에 실패했습니다.');\n            }\n          }\n        } else {\n          alert('해당 위치에 노드를 찾을 수 없습니다.');\n        }\n      }\n    } catch (error) {\n      console.error('맵 클릭 처리 중 오류 발생:', error);\n      alert('맵 클릭 처리 중 오류가 발생했습니다.');\n    } finally {\n      // handleMapClick 이 끝나면 노드 정보를 다시 fetch하도록\n      await fetchNodes(selectedMap._id);\n      drawNodes();\n    }\n  };\n\n  // 노드 간 총 꺾인 경로 거리 계산 함수\n  const calculateTotalDistance = (node1Id, node2Id, waypoints) => {\n    const node1 = nodes.find(n => n._id === node1Id);\n    const node2 = nodes.find(n => n._id === node2Id);\n    if (!node1 || !node2) return 0;\n    let totalDistance = 0;\n\n    // 거리 계산 함수 (직선 거리)\n    const distance = (x1, y1, x2, y2) => Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);\n\n    // 노드1에서 첫 번째 웨이포인트까지 거리\n    if (waypoints.length > 0) {\n      totalDistance += distance(node1.x, node1.y, waypoints[0].x, waypoints[0].y);\n\n      // 각 웨이포인트 간 거리 합산\n      for (let i = 0; i < waypoints.length - 1; i++) {\n        totalDistance += distance(waypoints[i].x, waypoints[i].y, waypoints[i + 1].x, waypoints[i + 1].y);\n      }\n\n      // 마지막 웨이포인트에서 노드2까지 거리 추가\n      totalDistance += distance(waypoints[waypoints.length - 1].x, waypoints[waypoints.length - 1].y, node2.x, node2.y);\n    } else {\n      // 웨이포인트가 없는 경우, 노드1과 노드2 간 직선 거리\n      totalDistance += distance(node1.x, node1.y, node2.x, node2.y);\n    }\n    return totalDistance;\n  };\n\n  // 노드 생성을 제출하는 함수\n  const handleSubmitNode = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n    if (nodeName.trim().length === 0) {\n      alert('노드 이름을 입력해주세요.');\n      return;\n    }\n    try {\n      await axios.post('http://172.30.1.30:5557/map/nodes', {\n        name: nodeName,\n        x: nodeX,\n        y: nodeY,\n        mapId: selectedMap._id\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      alert('노드가 성공적으로 생성되었습니다.');\n      setIsNodePopupOpen(false);\n      setNodeName(''); // 입력 필드 초기화\n      setNodeX(null);\n      setNodeY(null);\n      await fetchNodes(selectedMap._id); // 노드 목록 갱신\n      drawNodes(); // 노드 및 간선 다시 그리기\n    } catch (error) {\n      console.error('노드 생성 중 오류 발생:', error);\n      alert('노드 생성에 실패했습니다.');\n    }\n  };\n\n  // 맵 삭제하는 함수\n  const handleDeleteMap = async mapId => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n    const confirmDelete = window.confirm('이 맵을 삭제하시겠습니까?');\n    if (!confirmDelete) return;\n    try {\n      await axios.put(`http://172.30.1.30:5557/map/delete/${mapId}`, {}, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      alert('맵이 성공적으로 삭제되었습니다.');\n      await fetchMaps();\n      if (selectedMap && selectedMap._id === mapId) {\n        setSelectedMap(null); // 선택된 맵을 삭제한 경우 초기화\n        setMapImage(null); // 맵 이미지 초기화\n        setNodes([]); // 노드 목록 초기화\n        setNoGoZones([]); // 금지구역 초기화\n      }\n    } catch (error) {\n      console.error('맵 삭제 중 오류 발생:', error);\n      alert('맵 삭제에 실패했습니다.');\n    }\n  };\n\n  // 맵 파일 변경 시 호출되는 함수\n  const handleFileChange = e => {\n    setMapFile(e.target.files[0]);\n  };\n\n  // YAML 파일 변경 시 호출되는 함수\n  const handleYamlFileChange = e => {\n    setYamlFile(e.target.files[0]);\n  };\n\n  // 맵 업데이트를 처리하는 함수\n  const handleUpdateMap = async e => {\n    e.preventDefault();\n    if (editName.length < 2) {\n      alert('맵 이름은 최소 2자 이상이어야 합니다.');\n      return;\n    }\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n    try {\n      await axios.put(`http://172.30.1.30:5557/map/update/${selectedMap._id}`, {\n        name: editName,\n        description: editDescription,\n        isMonitored // 모니터링 지도 상태 포함\n      }, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      alert('맵이 성공적으로 업데이트되었습니다.');\n      setIsEditPopupOpen(false); // 수정 후 팝업 닫기\n      await fetchMaps();\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('맵 업데이트 중 오류 발생:', error);\n      alert(`맵 업데이트 중 오류 발생: ${((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message}`);\n    }\n  };\n\n  // 맵 업로드를 처리하는 함수\n  const handleUploadMap = async e => {\n    e.preventDefault();\n    if (uploadName.length < 2) {\n      alert('맵 이름은 최소 2자 이상이어야 합니다.');\n      return;\n    }\n    const formData = new FormData();\n    formData.append('name', uploadName);\n    formData.append('description', uploadDescription);\n    formData.append('file', mapFile);\n    formData.append('yaml', yamlFile);\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n    try {\n      await axios.post('http://172.30.1.30:5557/map/upload', formData, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      alert('맵이 성공적으로 업로드되었습니다.');\n      setIsUploadPopupOpen(false); // 업로드 후 팝업 닫기\n      await fetchMaps();\n    } catch (error) {\n      console.error('맵 업로드 중 오류 발생:', error);\n      alert('맵 업로드에 실패했습니다.');\n    }\n  };\n\n  // 맵 수정 팝업을 여는 함수\n  const openEditPopup = map => {\n    setSelectedMap(map);\n    setEditName(map.name);\n    setEditDescription(map.description);\n    setIsMonitored(map.isMonitored || false); // 모니터링 상태 설정\n    setIsEditPopupOpen(true); // 수정 팝업 열기\n  };\n\n  // 노드 생성 모드를 활성화하는 함수\n  const handleCreateNodeMode = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    setIsCreatingNode(true);\n    document.body.style.cursor = 'crosshair'; // 마우스 커서를 십자가 모양으로 변경\n  };\n\n  // URL 객체 해제를 위한 useEffect\n  useEffect(() => {\n    return () => {\n      if (mapImage) {\n        URL.revokeObjectURL(mapImage);\n      }\n    };\n  }, [mapImage]);\n\n  // 노드 삭제 모드를 활성화하는 함수\n  const handleDeleteNodeMode = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    setIsDeletingNode(true);\n    document.body.style.cursor = 'not-allowed'; // 커서를 삭제 모드로 변경\n  };\n\n  // Send to Robots 버튼과 관련된 함수 추가\n  const handleSendMap = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n    try {\n      await axios.post('http://172.30.1.30:5559/robot/send_map', {}, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      alert('맵이 로봇에게 성공적으로 전송되었습니다.');\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      console.error('맵을 로봇에게 전송하는 중 오류 발생:', error);\n      alert(`맵을 로봇에게 전송하는 중 오류 발생: ${((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || error.message}`);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"map-management-page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 820,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    className: \"map-management-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 822,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(UserInfo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 823,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(LogoutButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 824,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 826,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"toolbar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 829,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleCreateNodeMode,\n    className: \"create-node-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 830,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faPlus,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 831,\n      columnNumber: 11\n    }\n  }), \" \\uB178\\uB4DC \\uC0DD\\uC131\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleDeleteNodeMode,\n    className: \"delete-node-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 833,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faEdit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 834,\n      columnNumber: 11\n    }\n  }), \" \\uB178\\uB4DC \\uC0AD\\uC81C\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleConnectNodeMode,\n    className: \"connect-node-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 836,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faLink,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 837,\n      columnNumber: 11\n    }\n  }), \" \\uB178\\uB4DC \\uC5F0\\uACB0 \"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleDisconnectNodeMode,\n    className: \"disconnect-node-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 839,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faUnlink,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 840,\n      columnNumber: 11\n    }\n  }), \" \\uC5F0\\uACB0 \\uD574\\uC81C \"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleCreateNoGoZone,\n    className: \"create-nogozone-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 843,\n      columnNumber: 9\n    }\n  }, \"\\uAE08\\uC9C0 \\uAD6C\\uC5ED \\uC0DD\\uC131\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"map-management-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 852,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"map-list-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 854,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"map-list-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 855,\n      columnNumber: 11\n    }\n  }, \"\\uB9F5 \\uB9AC\\uC2A4\\uD2B8\", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setIsUploadPopupOpen(true),\n    className: \"add-map-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 857,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faPlus,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 861,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"map-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 864,\n      columnNumber: 11\n    }\n  }, maps.map(map => /*#__PURE__*/React.createElement(\"li\", {\n    key: map._id,\n    className: `map-list-item ${(selectedMap === null || selectedMap === void 0 ? void 0 : selectedMap._id) === map._id ? 'selected-map' : ''}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 866,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    onClick: () => handleSelectMap(map),\n    className: \"map-list-item-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 870,\n      columnNumber: 17\n    }\n  }, map.name), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => openEditPopup(map),\n    className: \"edit-map-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 876,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faEdit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 880,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => handleDeleteMap(map._id),\n    className: \"delete-map-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 882,\n      columnNumber: 17\n    }\n  }, \"\\xD7\")))), selectedMap && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"map-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 893,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 894,\n      columnNumber: 15\n    }\n  }, \"\\uB9F5 \\uC124\\uBA85\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 895,\n      columnNumber: 15\n    }\n  }, selectedMap.description))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"map-image-and-node-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 901,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"map-image-container\",\n    style: {\n      position: 'relative'\n    },\n    onClick: handleMapClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 903,\n      columnNumber: 11\n    }\n  }, mapImage ? /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    className: \"map-canvas\",\n    style: {\n      cursor: isCreatingNode ? 'crosshair' : connectionStep !== 'idle' || disconnectStep !== 'idle' ? 'pointer' : 'default'\n    } // 커서 스타일 수정\n    ,\n    onMouseMove: handleMouseMove,\n    onMouseLeave: handleMouseLeave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 909,\n      columnNumber: 15\n    }\n  }) : /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 917,\n      columnNumber: 15\n    }\n  }, \"\\uB9F5\\uC744 \\uC120\\uD0DD\\uD558\\uC5EC \\uC774\\uBBF8\\uC9C0\\uB97C \\uD655\\uC778\\uD558\\uC138\\uC694.\"), selectedMap && /*#__PURE__*/React.createElement(\"button\", {\n    className: \"send-to-robots-button\",\n    onClick: handleSendMap,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 922,\n      columnNumber: 15\n    }\n  }, \"\\uB85C\\uBD07\\uC5D0\\uAC8C \\uC804\\uC1A1\")), /*#__PURE__*/React.createElement(NodeList, {\n    nodes: nodes,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 932,\n      columnNumber: 11\n    }\n  }), \" \")), isNodePopupOpen && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popup-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 938,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 939,\n      columnNumber: 11\n    }\n  }, \"\\uB178\\uB4DC \\uC0DD\\uC131\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 940,\n      columnNumber: 11\n    }\n  }, \"X: \", nodeX.toFixed(2), \", Y: \", nodeY.toFixed(2)), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: nodeName,\n    onChange: e => setNodeName(e.target.value),\n    placeholder: \"\\uB178\\uB4DC \\uC774\\uB984 \\uC785\\uB825\",\n    className: \"popup-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 941,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popup-button-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 948,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleSubmitNode,\n    className: \"popup-submit-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 949,\n      columnNumber: 13\n    }\n  }, \"\\uC0DD\\uC131\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setIsNodePopupOpen(false),\n    className: \"popup-cancel-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 952,\n      columnNumber: 13\n    }\n  }, \"\\uCDE8\\uC18C\"))), isUploadPopupOpen && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popup-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 964,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 965,\n      columnNumber: 11\n    }\n  }, \"\\uB9F5 \\uC5C5\\uB85C\\uB4DC\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleUploadMap,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 966,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: uploadName,\n    onChange: e => setUploadName(e.target.value),\n    placeholder: \"\\uB9F5 \\uC774\\uB984\",\n    required: true,\n    className: \"popup-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 967,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"textarea\", {\n    value: uploadDescription,\n    onChange: e => setUploadDescription(e.target.value),\n    placeholder: \"\\uB9F5 \\uC124\\uBA85\",\n    required: true,\n    className: \"popup-textarea\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 975,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 982,\n      columnNumber: 13\n    }\n  }, \"\\uB9F5 \\uD30C\\uC77C (.pgm, .png, .jpg)\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    accept: \".pgm,.png,.jpg\",\n    onChange: handleFileChange,\n    required: true,\n    className: \"popup-file-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 983,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 990,\n      columnNumber: 13\n    }\n  }, \"YAML \\uD30C\\uC77C (.yaml)\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    accept: \".yaml\",\n    onChange: handleYamlFileChange,\n    required: true,\n    className: \"popup-file-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 991,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popup-button-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 998,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"popup-submit-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 999,\n      columnNumber: 15\n    }\n  }, \"\\uC5C5\\uB85C\\uB4DC\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: () => setIsUploadPopupOpen(false),\n    className: \"popup-cancel-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1002,\n      columnNumber: 15\n    }\n  }, \"\\uCDE8\\uC18C\")))), isEditPopupOpen && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popup-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1016,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1017,\n      columnNumber: 11\n    }\n  }, \"\\uB9F5 \\uC218\\uC815\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleUpdateMap,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1018,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: editName,\n    onChange: e => setEditName(e.target.value),\n    placeholder: \"\\uB9F5 \\uC774\\uB984\",\n    required: true,\n    className: \"popup-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1019,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"textarea\", {\n    value: editDescription,\n    onChange: e => setEditDescription(e.target.value),\n    placeholder: \"\\uB9F5 \\uC124\\uBA85\",\n    required: true,\n    className: \"popup-textarea\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1027,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    style: {\n      marginTop: '10px',\n      color: '#333'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1035,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    checked: isMonitored,\n    onChange: e => setIsMonitored(e.target.checked),\n    style: {\n      marginRight: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1036,\n      columnNumber: 15\n    }\n  }), \"\\uBAA8\\uB2C8\\uD130\\uB9C1 \\uB9F5\\uC73C\\uB85C \\uC124\\uC815\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popup-button-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1044,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"popup-submit-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1045,\n      columnNumber: 15\n    }\n  }, \"\\uC5C5\\uB370\\uC774\\uD2B8\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: () => setIsEditPopupOpen(false),\n    className: \"popup-cancel-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1048,\n      columnNumber: 15\n    }\n  }, \"\\uCDE8\\uC18C\")))), hoveredNode && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tooltip\",\n    style: {\n      position: 'fixed',\n      top: `${tooltipPosition.y + 10}px`,\n      left: `${tooltipPosition.x + 10}px`,\n      backgroundColor: 'rgba(0, 0, 0, 0.7)',\n      color: 'white',\n      padding: '5px 10px',\n      borderRadius: '4px',\n      pointerEvents: 'none',\n      zIndex: 1000,\n      fontSize: '12px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1062,\n      columnNumber: 9\n    }\n  }, hoveredNode.name), /*#__PURE__*/React.createElement(NodeDisconnect, {\n    firstNodeId: disconnectFirstNodeId,\n    secondNodeId: disconnectSecondNodeId,\n    onDisconnectSuccess: async isDeleted => {\n      if (isDeleted) {\n        // 삭제가 완료된 경우에만 실행\n        setDisconnectFirstNodeId(null);\n        setDisconnectSecondNodeId(null);\n        await fetchNodes(selectedMap._id); // 노드 정보 갱신\n        drawNodes(); // 갱신된 정보로 노드 및 간선 다시 그리기\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1082,\n      columnNumber: 7\n    }\n  }), isCreatingNoGoZone && /*#__PURE__*/React.createElement(NoGoZone, {\n    mapId: selectedMap === null || selectedMap === void 0 ? void 0 : selectedMap._id,\n    onClose: () => setIsCreatingNoGoZone(false),\n    onNoGoZoneCreated: async () => {\n      await fetchNoGoZones(selectedMap._id);\n      setIsCreatingNoGoZone(false);\n      drawNodes(); // 노드 및 금지구역 다시 그리기\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1097,\n      columnNumber: 9\n    }\n  }));\n}\nexport default Mapmanage;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","FontAwesomeIcon","faEdit","faPlus","faLink","faUnlink","Navbar","LogoutButton","UserInfo","worldToMap","mapToWorld","NodeList","NodeDisconnect","NoGoZone","Mapmanage","maps","setMaps","selectedMap","setSelectedMap","editName","setEditName","editDescription","setEditDescription","isMonitored","setIsMonitored","uploadName","setUploadName","uploadDescription","setUploadDescription","mapFile","setMapFile","yamlFile","setYamlFile","mapImage","setMapImage","isUploadPopupOpen","setIsUploadPopupOpen","isEditPopupOpen","setIsEditPopupOpen","isCreatingNode","setIsCreatingNode","nodeX","setNodeX","nodeY","setNodeY","nodeName","setNodeName","isNodePopupOpen","setIsNodePopupOpen","canvasRef","mapImageRef","nodes","setNodes","isDeletingNode","setIsDeletingNode","imageNaturalWidth","setImageNaturalWidth","imageNaturalHeight","setImageNaturalHeight","hoveredNode","setHoveredNode","tooltipPosition","setTooltipPosition","x","y","connectionStep","setConnectionStep","waypointCount","setWaypointCount","currentWaypoint","setCurrentWaypoint","waypoints","setWaypoints","firstNodeId","setFirstNodeId","disconnectStep","setDisconnectStep","disconnectFirstNodeId","setDisconnectFirstNodeId","disconnectSecondNodeId","setDisconnectSecondNodeId","isCreatingNoGoZone","setIsCreatingNoGoZone","noGoZones","setNoGoZones","fetchMaps","token","localStorage","getItem","alert","response","get","headers","data","length","handleSelectMap","error","console","fetchNodes","mapId","status","fetchNoGoZones","map","name","description","_id","Authorization","responseType","imageUrl","URL","createObjectURL","loadMapImage","canvas","current","ctx","getContext","Image","src","onload","imgWidth","width","imgHeight","height","clearRect","drawImage","drawNodes","mapToMapCoordinates","forEach","zone","topLeft","bottomRight","fillStyle","fillRect","strokeStyle","lineWidth","strokeRect","node","connections","connection","connectedNode","find","n","startX","startY","endX","endY","beginPath","moveTo","wp","wpX","wpY","lineTo","stroke","size","startsWith","document","body","style","cursor","handleMouseMove","e","rect","getBoundingClientRect","mouseX","clientX","left","mouseY","clientY","top","foundNode","distance","Math","sqrt","handleMouseLeave","handleConnectNodeMode","count","parseInt","prompt","isNaN","handleDisconnectNodeMode","handleCreateNoGoZone","handleMapClick","clickX","clickY","clickedNode","newWaypoint","totalDistance","calculateTotalDistance","post","node1","node2","toFixed","nodeToDelete","confirmDelete","window","confirm","put","node1Id","node2Id","x1","y1","x2","y2","i","handleSubmitNode","trim","handleDeleteMap","handleFileChange","target","files","handleYamlFileChange","handleUpdateMap","preventDefault","_error$response","_error$response$data","message","handleUploadMap","formData","FormData","append","openEditPopup","handleCreateNodeMode","revokeObjectURL","handleDeleteNodeMode","handleSendMap","_error$response2","_error$response2$data","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onClick","icon","key","position","ref","onMouseMove","onMouseLeave","type","value","onChange","placeholder","onSubmit","required","accept","marginTop","color","checked","marginRight","backgroundColor","padding","borderRadius","pointerEvents","zIndex","fontSize","secondNodeId","onDisconnectSuccess","isDeleted","onClose","onNoGoZoneCreated"],"sources":["/home/ketgintern/Desktop/FMS-AGV-AMR/frontend/src/pages/Map/Mapmanage.js"],"sourcesContent":["// src/components/MapManage/Mapmanage.js\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEdit, faPlus, faLink, faUnlink } from '@fortawesome/free-solid-svg-icons';\n\nimport Navbar from '../../components/Common/Navbar';\nimport LogoutButton from '../../components/Common/LogoutButton';\nimport UserInfo from '../../components/Common/UserInfo';\nimport './Mapmanage.css';\nimport { worldToMap, mapToWorld } from '../../utils/coordinateUtils';\nimport NodeList from './NodeList'; // NodeList 컴포넌트 임포트\nimport NodeDisconnect from './NodeDisconnect'; // NodeDisconnect 컴포넌트 임포트\nimport NoGoZone from './NoGoZone'; // NoGoZone 컴포넌트 임포트\n\nfunction Mapmanage() {\n  const [maps, setMaps] = useState([]);\n  const [selectedMap, setSelectedMap] = useState(null); // 선택된 맵 상태\n  const [editName, setEditName] = useState('');\n  const [editDescription, setEditDescription] = useState('');\n  const [isMonitored, setIsMonitored] = useState(false); // 모니터링 설정 체크박스 상태\n  const [uploadName, setUploadName] = useState('');\n  const [uploadDescription, setUploadDescription] = useState('');\n  const [mapFile, setMapFile] = useState(null);\n  const [yamlFile, setYamlFile] = useState(null);\n  const [mapImage, setMapImage] = useState(null);\n  const [isUploadPopupOpen, setIsUploadPopupOpen] = useState(false); // 업로드 팝업 상태\n  const [isEditPopupOpen, setIsEditPopupOpen] = useState(false); // 수정 팝업 상태\n  const [isCreatingNode, setIsCreatingNode] = useState(false); // 노드 생성 모드\n  const [nodeX, setNodeX] = useState(null); // X 좌표\n  const [nodeY, setNodeY] = useState(null); // Y 좌표\n  const [nodeName, setNodeName] = useState(''); // 노드 이름\n  const [isNodePopupOpen, setIsNodePopupOpen] = useState(false); // 노드 팝업 상태\n  const canvasRef = useRef(null); // 캔버스 참조\n  const mapImageRef = useRef(null); // 지도 이미지 참조\n  const [nodes, setNodes] = useState([]); // 노드 목록 저장\n  const [isDeletingNode, setIsDeletingNode] = useState(false);\n\n  const [imageNaturalWidth, setImageNaturalWidth] = useState(null);\n  const [imageNaturalHeight, setImageNaturalHeight] = useState(null);\n\n  // Hover 상태 관리\n  const [hoveredNode, setHoveredNode] = useState(null);\n  const [tooltipPosition, setTooltipPosition] = useState({ x: 0, y: 0 });\n\n  // 연결 단계 관리\n  const [connectionStep, setConnectionStep] = useState('idle'); // 'idle', 'selectingFirstNode', 'selectingWaypoints', 'selectingSecondNode'\n  const [waypointCount, setWaypointCount] = useState(0); // 웨이포인트 개수\n  const [currentWaypoint, setCurrentWaypoint] = useState(0); // 현재 웨이포인트 수\n  const [waypoints, setWaypoints] = useState([]); // 웨이포인트 배열\n  const [firstNodeId, setFirstNodeId] = useState(null); // 첫 번째 노드 ID\n\n  // 연결 해제 단계 관리\n  const [disconnectStep, setDisconnectStep] = useState('idle'); // 'idle', 'selectingFirstNode', 'selectingSecondNode'\n  const [disconnectFirstNodeId, setDisconnectFirstNodeId] = useState(null);\n  const [disconnectSecondNodeId, setDisconnectSecondNodeId] = useState(null);\n\n  // 금지구역 관련 상태\n  const [isCreatingNoGoZone, setIsCreatingNoGoZone] = useState(false);\n  const [noGoZones, setNoGoZones] = useState([]);\n\n  // 맵 목록을 서버에서 가져오는 함수\n  const fetchMaps = async () => {\n    const token = localStorage.getItem('token');\n\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n\n    try {\n      const response = await axios.get('http://172.30.1.30:5557/map/maps', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setMaps(response.data);\n\n      // 맵이 하나 이상 있을 경우 첫 번째 맵을 자동으로 선택\n      if (response.data.length > 0) {\n        await handleSelectMap(response.data[0]);\n      }\n    } catch (error) {\n      console.error('맵을 가져오는 중 오류 발생:', error);\n      alert('맵을 가져오는 데 실패했습니다.');\n    }\n  };\n\n  useEffect(() => {\n    fetchMaps();\n  }, []);\n\n  // 노드 목록을 서버에서 가져오는 함수\n  const fetchNodes = async (mapId) => {\n    try {\n      const response = await axios.get(`http://172.30.1.30:5557/map/nodes/${mapId}`);\n      if (response.status === 200) {\n        setNodes(response.data); // 노드 리스트 상태 업데이트\n      } else {\n        setNodes([]); // 실패 시 빈 배열로 초기화\n      }\n    } catch (error) {\n      console.error('노드를 가져오는 중 오류 발생:', error);\n      setNodes([]); // 오류 발생 시에도 빈 배열로 초기화\n      alert('노드를 가져오는 데 실패했습니다.');\n    }\n  };\n\n  // 금지구역 목록을 서버에서 가져오는 함수\n  const fetchNoGoZones = async (mapId) => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n    try {\n      const response = await axios.get(`http://172.30.1.30:5557/api/no-go-zones/map/${mapId}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n        },\n      });\n      setNoGoZones(response.data);\n    } catch (error) {\n      console.error('금지구역을 가져오는 중 오류 발생:', error);\n      alert('금지구역을 가져오는 데 실패했습니다.');\n    }\n  };\n\n  // 맵을 선택했을 때 호출되는 함수\n  const handleSelectMap = async (map) => {\n    setSelectedMap(map); // 맵 선택 상태 업데이트\n    setEditName(map.name);\n    setEditDescription(map.description);\n    setIsMonitored(map.isMonitored || false); // 모니터링 지도 상태 설정\n\n    // 맵 이미지 가져오기\n    const token = localStorage.getItem('token');\n    try {\n      const response = await axios.get(`http://172.30.1.30:5557/map/file/${map._id}`, {\n        headers: { Authorization: `Bearer ${token}` },\n        responseType: 'blob',\n      });\n      const imageUrl = URL.createObjectURL(response.data);\n      setMapImage(imageUrl); // 이미지 설정\n    } catch (error) {\n      console.error('맵 이미지를 가져오는 중 오류 발생:', error);\n      alert('맵 이미지를 가져오는 데 실패했습니다.');\n    }\n\n    // 금지구역 가져오기\n    await fetchNoGoZones(map._id);\n  };\n\n  // 이미지 로드 시 호출되는 함수 (지도 이미지를 캔버스에 그리기)\n  const loadMapImage = () => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext('2d');\n    mapImageRef.current = new Image();\n    mapImageRef.current.src = mapImage;\n\n    mapImageRef.current.onload = () => {\n      const imgWidth = mapImageRef.current.width;\n      const imgHeight = mapImageRef.current.height;\n      setImageNaturalWidth(imgWidth);\n      setImageNaturalHeight(imgHeight);\n\n      // 캔버스 크기 조정 및 기존 내용 클리어\n      canvas.width = imgWidth;\n      canvas.height = imgHeight;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      // 지도 이미지를 캔버스에 그리기\n      ctx.drawImage(mapImageRef.current, 0, 0, imgWidth, imgHeight);\n      drawNodes(); // 노드 그리기\n    };\n  };\n\n  // 맵 좌표계를 캔버스 좌표계로 변환하는 함수\n  const mapToMapCoordinates = (x, y) => {\n    return worldToMap(x, y, imageNaturalWidth, imageNaturalHeight);\n  };\n\n  // 노드를 캔버스에 그리는 함수\n  const drawNodes = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n\n    if (!canvas || !imageNaturalWidth || !imageNaturalHeight) return;\n\n    // 기존 노드 그리기 전에 캔버스를 클리어\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // 지도 이미지 다시 그리기\n    ctx.drawImage(mapImageRef.current, 0, 0, imageNaturalWidth, imageNaturalHeight);\n\n    // 금지구역 그리기\n    noGoZones.forEach((zone) => {\n      const topLeft = mapToMapCoordinates(zone.topLeft.x, zone.topLeft.y);\n      const bottomRight = mapToMapCoordinates(zone.bottomRight.x, zone.bottomRight.y);\n      const width = bottomRight.x - topLeft.x;\n      const height = bottomRight.y - topLeft.y;\n      ctx.fillStyle = 'rgba(255, 0, 0, 0.3)';\n      ctx.fillRect(topLeft.x, topLeft.y, width, height);\n      ctx.strokeStyle = 'red';\n      ctx.lineWidth = 2;\n      ctx.strokeRect(topLeft.x, topLeft.y, width, height);\n    });\n\n    // 연결선을 먼저 그리기\n    nodes.forEach((node) => {\n      node.connections.forEach((connection) => {\n        const connectedNode = nodes.find(n => n._id === connection.node);\n        if (connectedNode) {\n          const { x: startX, y: startY } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const { x: endX, y: endY } = worldToMap(connectedNode.x, connectedNode.y, imageNaturalWidth, imageNaturalHeight);\n\n          ctx.strokeStyle = 'blue';\n          ctx.lineWidth = 2;\n          ctx.beginPath();\n          ctx.moveTo(startX, startY);\n\n          // 웨이포인트가 있는 경우\n          if (connection.waypoints && connection.waypoints.length > 0) {\n            connection.waypoints.forEach((wp) => {\n              const { x: wpX, y: wpY } = worldToMap(wp.x, wp.y, imageNaturalWidth, imageNaturalHeight);\n              ctx.lineTo(wpX, wpY);\n            });\n          }\n\n          ctx.lineTo(endX, endY);\n          ctx.stroke();\n        }\n      });\n    });\n\n    // 노드 그리기\n    nodes.forEach((node) => {\n      const { x, y } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n      const size = 10;\n      ctx.fillStyle = 'red';\n      ctx.fillRect(x - size / 2, y - size / 2, size, size);\n    });\n  };\n\n  // 이미지 로드 후 캔버스에 지도 그리기\n  useEffect(() => {\n    if (mapImage) {\n      loadMapImage();\n    }\n  }, [mapImage]);\n\n  // 맵 이미지와 selectedMap이 모두 설정된 후 노드 패치\n  useEffect(() => {\n    if (mapImage && selectedMap) {\n      fetchNodes(selectedMap._id);\n    }\n  }, [mapImage, selectedMap]);\n\n  // 노드 변경 시마다 노드를 다시 그리기\n  useEffect(() => {\n    if (canvasRef.current && mapImageRef.current) {\n      drawNodes(); // 노드를 다시 그리기\n    }\n  }, [nodes, noGoZones]);\n\n  // 금지구역 변경 시마다 노드를 다시 그리기\n  useEffect(() => {\n    if (canvasRef.current && mapImageRef.current) {\n      drawNodes(); // 금지구역이 변경되면 노드와 함께 다시 그리기\n    }\n  }, [noGoZones]);\n\n  // 노드 삭제 시 커서 복구\n  useEffect(() => {\n    if (\n      !isDeletingNode &&\n      !connectionStep.startsWith('selecting') &&\n      !disconnectStep.startsWith('selecting')\n    ) {\n      document.body.style.cursor = 'default'; // 삭제 모드 및 연결 모드가 아닐 때 커서를 기본으로 복구\n    }\n  }, [isDeletingNode, connectionStep, disconnectStep]);\n\n  // 맵을 선택했을 때 노드 및 금지구역을 그리기 위해 fetchNodes와 fetchNoGoZones를 호출 후 drawNodes를 호출할 필요가 있음\n\n  // 마우스가 캔버스 위를 움직일 때 노드 호버 상태 업데이트\n  const handleMouseMove = (e) => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const mouseX = e.clientX - rect.left;\n    const mouseY = e.clientY - rect.top;\n\n    let foundNode = null;\n\n    for (let node of nodes) {\n      const { x, y } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n      const distance = Math.sqrt((mouseX - x) ** 2 + (mouseY - y) ** 2);\n      if (distance < 5) { // 노드 반경 5px 내에 있을 때\n        foundNode = node;\n        break;\n      }\n    }\n\n    if (foundNode) {\n      setHoveredNode(foundNode);\n      setTooltipPosition({ x: e.clientX, y: e.clientY });\n    } else {\n      setHoveredNode(null);\n    }\n  };\n\n  // 마우스가 캔버스를 벗어났을 때 호버 상태 초기화\n  const handleMouseLeave = () => {\n    setHoveredNode(null);\n  };\n\n  // 연결 모드 활성화 함수 (웨이포인트 추가 프로세스 시작)\n  const handleConnectNodeMode = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    const count = parseInt(prompt('추가할 웨이포인트의 개수를 입력하세요:', '0'), 10);\n    if (isNaN(count) || count < 0) {\n      alert('유효한 숫자를 입력해주세요.');\n      return;\n    }\n    setWaypointCount(count);\n    if (count > 0) {\n      setConnectionStep('selectingFirstNode');\n      setWaypoints([]);\n      setCurrentWaypoint(0);\n      alert('첫 번째 노드를 선택하세요.');\n      document.body.style.cursor = 'pointer'; // 연결 모드 커서로 변경\n    } else {\n      setConnectionStep('selectingFirstNode');\n      setWaypoints([]);\n      setCurrentWaypoint(0);\n      alert('첫 번째 노드를 선택하세요.');\n      document.body.style.cursor = 'pointer'; // 연결 모드 커서로 변경\n    }\n  };\n\n  // 연결 해제 모드 활성화 함수\n  const handleDisconnectNodeMode = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    setDisconnectStep('selectingFirstNode');\n    setDisconnectFirstNodeId(null);\n    setDisconnectSecondNodeId(null);\n    alert('연결을 해제할 첫 번째 노드를 선택하세요.');\n    document.body.style.cursor = 'pointer'; // 연결 해제 모드 커서로 변경\n  };\n\n  // 금지구역 생성 모드 활성화 함수\n  const handleCreateNoGoZone = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    setIsCreatingNoGoZone(true);\n  };\n\n  // 맵 이미지 클릭 시 노드 생성, 삭제, 연결 또는 웨이포인트 추가, 연결 해제\n  const handleMapClick = async (e) => {\n    if (!selectedMap) return;\n\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const clickX = e.clientX - rect.left;\n    const clickY = e.clientY - rect.top;\n\n    const { x, y } = mapToWorld(clickX, clickY, imageNaturalWidth, imageNaturalHeight);\n\n    try {\n      // 연결 해제 모드 처리\n      if (disconnectStep === 'selectingFirstNode') {\n        // 첫 번째 노드 선택\n        let clickedNode = null;\n        for (let node of nodes) {\n          const { x: nodeX, y: nodeY } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            clickedNode = node;\n            break;\n          }\n        }\n\n        if (clickedNode) {\n          setDisconnectFirstNodeId(clickedNode._id);\n          setDisconnectStep('selectingSecondNode');\n          alert('연결을 해제할 두 번째 노드를 선택하세요.');\n        } else {\n          alert('유효한 노드를 클릭해주세요.');\n        }\n        return; // 연결 해제 모드일 때 다른 모드 처리하지 않도록 return\n      }\n\n      if (disconnectStep === 'selectingSecondNode') {\n        // 두 번째 노드 선택 및 연결 해제\n        let clickedNode = null;\n        for (let node of nodes) {\n          const { x: nodeX, y: nodeY } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            clickedNode = node;\n            break;\n          }\n        }\n\n        if (clickedNode) {\n          if (clickedNode._id === disconnectFirstNodeId) {\n            alert('같은 노드를 선택했습니다. 다른 노드를 선택해주세요.');\n            return;\n          }\n          setDisconnectSecondNodeId(clickedNode._id);\n          setDisconnectStep('idle');\n          document.body.style.cursor = 'default'; // 커서 복구\n        } else {\n          alert('유효한 노드를 클릭해주세요.');\n        }\n        \n        return; // 연결 해제 모드일 때 다른 모드 처리하지 않도록 return\n      }\n\n      // 기존 연결 및 노드 생성, 삭제 모드 처리\n      if (connectionStep === 'selectingFirstNode') {\n        // 첫 번째 노드 선택\n        let clickedNode = null;\n        for (let node of nodes) {\n          const { x: nodeX, y: nodeY } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            clickedNode = node;\n            break;\n          }\n        }\n\n        if (clickedNode) {\n          setFirstNodeId(clickedNode._id);\n          if (waypointCount > 0) {\n            setConnectionStep('selectingWaypoints');\n            alert(`${waypointCount}개의 웨이포인트를 선택하세요.`);\n            document.body.style.cursor = 'crosshair'; // 웨이포인트 추가 모드 커서로 변경\n          } else {\n            setConnectionStep('selectingSecondNode');\n            alert('두 번째 노드를 선택하세요.');\n          }\n        } else {\n          alert('유효한 노드를 클릭해주세요.');\n        }\n      } else if (connectionStep === 'selectingWaypoints') {\n        // 웨이포인트 추가\n        const newWaypoint = { x, y };\n        setWaypoints([...waypoints, newWaypoint]);\n        setCurrentWaypoint(currentWaypoint + 1);\n\n        if (currentWaypoint + 1 === waypointCount) {\n          setConnectionStep('selectingSecondNode');\n          alert('두 번째 노드를 선택하세요.');\n          document.body.style.cursor = 'pointer'; // 연결 모드 커서로 변경\n        } else {\n          alert(`${currentWaypoint + 1}/${waypointCount} 웨이포인트가 추가되었습니다.`);\n        }\n      } else if (connectionStep === 'selectingSecondNode') {\n        // 두 번째 노드 선택\n        let clickedNode = null;\n        for (let node of nodes) {\n          const { x: nodeX, y: nodeY } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            clickedNode = node;\n            break;\n          }\n        }\n\n        if (clickedNode) {\n          if (clickedNode._id === firstNodeId) {\n            alert('같은 노드를 선택했습니다. 다른 노드를 선택해주세요.');\n            return;\n          }\n          try {\n            // 웨이포인트 포함 총 거리 계산\n            const totalDistance = calculateTotalDistance(firstNodeId, clickedNode._id, waypoints);\n\n            // API 요청: 연결 및 거리 정보 포함\n            const token = localStorage.getItem('token');\n            await axios.post(`http://172.30.1.30:5557/map/node/connect`, {\n              node1: firstNodeId,\n              node2: clickedNode._id,\n              waypoints: waypoints,\n              distance: totalDistance, // 거리 값 추가\n            }, {\n              headers: { Authorization: `Bearer ${token}` }\n            });\n\n            alert(`노드가 성공적으로 연결되었습니다. 전체 꺾인 경로의 가중치: ${totalDistance.toFixed(2)}`);\n\n            // 연결 생성 후 상태 초기화\n            setConnectionStep('idle');\n            setFirstNodeId(null);\n            setWaypoints([]);\n            setWaypointCount(0);\n            setCurrentWaypoint(0);\n            document.body.style.cursor = 'default'; // 커서 복구\n            await fetchNodes(selectedMap._id); // 노드 목록 갱신\n            drawNodes(); // 노드 및 간선 다시 그리기\n          } catch (error) {\n            console.error('노드 연결 중 오류 발생:', error);\n            alert('노드 연결에 실패했습니다.');\n          }\n        } else {\n          alert('유효한 노드를 클릭해주세요.');\n        }\n      } else if (isCreatingNode) {\n        // 노드 생성 로직\n        setNodeX(x);\n        setNodeY(y);\n        setIsCreatingNode(false);\n        setIsNodePopupOpen(true);\n        document.body.style.cursor = 'default';\n      } else if (isDeletingNode) {\n        // 클릭한 위치 근처에 있는 노드를 찾아 삭제\n        let nodeToDelete = null;\n        for (let node of nodes) {\n          const { x: nodeX, y: nodeY } = worldToMap(node.x, node.y, imageNaturalWidth, imageNaturalHeight);\n          const distance = Math.sqrt((clickX - nodeX) ** 2 + (clickY - nodeY) ** 2);\n          if (distance < 5) {\n            nodeToDelete = node;\n            break;\n          }\n        }\n\n        if (nodeToDelete) {\n          const confirmDelete = window.confirm(`노드 \"${nodeToDelete.name}\"를 삭제하시겠습니까?`);\n          if (confirmDelete) {\n            try {\n              const token = localStorage.getItem('token');\n              await axios.put(`http://172.30.1.30:5557/map/node/${nodeToDelete._id}`, {}, { // 두 번째 인자를 빈 객체로 전달\n                headers: { Authorization: `Bearer ${token}` },\n              });\n              alert('노드가 성공적으로 삭제되었습니다.');\n\n              // 노드 목록을 다시 패치하고, 노드를 다시 그리기\n              await fetchNodes(selectedMap._id);\n              drawNodes(); // 삭제 후 노드를 다시 그리기\n\n              setIsDeletingNode(false); // 삭제 후 삭제 모드 종료\n            } catch (error) {\n              console.error('노드 삭제 중 오류 발생:', error);\n              alert('노드 삭제에 실패했습니다.');\n            }\n          }\n        } else {\n          alert('해당 위치에 노드를 찾을 수 없습니다.');\n        }\n      }\n    } catch (error) {\n      console.error('맵 클릭 처리 중 오류 발생:', error);\n      alert('맵 클릭 처리 중 오류가 발생했습니다.');\n    } finally {\n      // handleMapClick 이 끝나면 노드 정보를 다시 fetch하도록\n      await fetchNodes(selectedMap._id);\n      drawNodes();\n    }\n  };\n\n  // 노드 간 총 꺾인 경로 거리 계산 함수\n  const calculateTotalDistance = (node1Id, node2Id, waypoints) => {\n    const node1 = nodes.find(n => n._id === node1Id);\n    const node2 = nodes.find(n => n._id === node2Id);\n    if (!node1 || !node2) return 0;\n\n    let totalDistance = 0;\n\n    // 거리 계산 함수 (직선 거리)\n    const distance = (x1, y1, x2, y2) => Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);\n\n    // 노드1에서 첫 번째 웨이포인트까지 거리\n    if (waypoints.length > 0) {\n      totalDistance += distance(node1.x, node1.y, waypoints[0].x, waypoints[0].y);\n\n      // 각 웨이포인트 간 거리 합산\n      for (let i = 0; i < waypoints.length - 1; i++) {\n        totalDistance += distance(waypoints[i].x, waypoints[i].y, waypoints[i + 1].x, waypoints[i + 1].y);\n      }\n\n      // 마지막 웨이포인트에서 노드2까지 거리 추가\n      totalDistance += distance(waypoints[waypoints.length - 1].x, waypoints[waypoints.length - 1].y, node2.x, node2.y);\n    } else {\n      // 웨이포인트가 없는 경우, 노드1과 노드2 간 직선 거리\n      totalDistance += distance(node1.x, node1.y, node2.x, node2.y);\n    }\n\n    return totalDistance;\n  };\n\n  // 노드 생성을 제출하는 함수\n  const handleSubmitNode = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n\n    if (nodeName.trim().length === 0) {\n      alert('노드 이름을 입력해주세요.');\n      return;\n    }\n\n    try {\n      await axios.post('http://172.30.1.30:5557/map/nodes', {\n        name: nodeName,\n        x: nodeX,\n        y: nodeY,\n        mapId: selectedMap._id,\n      }, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      alert('노드가 성공적으로 생성되었습니다.');\n      setIsNodePopupOpen(false);\n      setNodeName(''); // 입력 필드 초기화\n      setNodeX(null);\n      setNodeY(null);\n      await fetchNodes(selectedMap._id); // 노드 목록 갱신\n      drawNodes(); // 노드 및 간선 다시 그리기\n    } catch (error) {\n      console.error('노드 생성 중 오류 발생:', error);\n      alert('노드 생성에 실패했습니다.');\n    }\n  };\n\n  // 맵 삭제하는 함수\n  const handleDeleteMap = async (mapId) => {\n    const token = localStorage.getItem('token');\n\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n\n    const confirmDelete = window.confirm('이 맵을 삭제하시겠습니까?');\n    if (!confirmDelete) return;\n\n    try {\n      await axios.put(`http://172.30.1.30:5557/map/delete/${mapId}`, {}, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      alert('맵이 성공적으로 삭제되었습니다.');\n      await fetchMaps();\n      if (selectedMap && selectedMap._id === mapId) {\n        setSelectedMap(null); // 선택된 맵을 삭제한 경우 초기화\n        setMapImage(null); // 맵 이미지 초기화\n        setNodes([]); // 노드 목록 초기화\n        setNoGoZones([]); // 금지구역 초기화\n      }\n    } catch (error) {\n      console.error('맵 삭제 중 오류 발생:', error);\n      alert('맵 삭제에 실패했습니다.');\n    }\n  };\n\n  // 맵 파일 변경 시 호출되는 함수\n  const handleFileChange = (e) => {\n    setMapFile(e.target.files[0]);\n  };\n\n  // YAML 파일 변경 시 호출되는 함수\n  const handleYamlFileChange = (e) => {\n    setYamlFile(e.target.files[0]);\n  };\n\n  // 맵 업데이트를 처리하는 함수\n  const handleUpdateMap = async (e) => {\n    e.preventDefault();\n\n    if (editName.length < 2) {\n      alert('맵 이름은 최소 2자 이상이어야 합니다.');\n      return;\n    }\n\n    const token = localStorage.getItem('token');\n\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n\n    try {\n      await axios.put(`http://172.30.1.30:5557/map/update/${selectedMap._id}`, {\n        name: editName,\n        description: editDescription,\n        isMonitored // 모니터링 지도 상태 포함\n      }, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      alert('맵이 성공적으로 업데이트되었습니다.');\n      setIsEditPopupOpen(false); // 수정 후 팝업 닫기\n      await fetchMaps();\n    } catch (error) {\n      console.error('맵 업데이트 중 오류 발생:', error);\n      alert(`맵 업데이트 중 오류 발생: ${error.response?.data?.message || error.message}`);\n    }\n  };\n\n  // 맵 업로드를 처리하는 함수\n  const handleUploadMap = async (e) => {\n    e.preventDefault();\n\n    if (uploadName.length < 2) {\n      alert('맵 이름은 최소 2자 이상이어야 합니다.');\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('name', uploadName);\n    formData.append('description', uploadDescription);\n    formData.append('file', mapFile);\n    formData.append('yaml', yamlFile);\n\n    const token = localStorage.getItem('token');\n\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n\n    try {\n      await axios.post('http://172.30.1.30:5557/map/upload', formData, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      alert('맵이 성공적으로 업로드되었습니다.');\n      setIsUploadPopupOpen(false); // 업로드 후 팝업 닫기\n      await fetchMaps();\n    } catch (error) {\n      console.error('맵 업로드 중 오류 발생:', error);\n      alert('맵 업로드에 실패했습니다.');\n    }\n  };\n\n  // 맵 수정 팝업을 여는 함수\n  const openEditPopup = (map) => {\n    setSelectedMap(map);\n    setEditName(map.name);\n    setEditDescription(map.description);\n    setIsMonitored(map.isMonitored || false); // 모니터링 상태 설정\n    setIsEditPopupOpen(true); // 수정 팝업 열기\n  };\n\n  // 노드 생성 모드를 활성화하는 함수\n  const handleCreateNodeMode = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    setIsCreatingNode(true);\n    document.body.style.cursor = 'crosshair'; // 마우스 커서를 십자가 모양으로 변경\n  };\n\n  // URL 객체 해제를 위한 useEffect\n  useEffect(() => {\n    return () => {\n      if (mapImage) {\n        URL.revokeObjectURL(mapImage);\n      }\n    };\n  }, [mapImage]);\n\n  // 노드 삭제 모드를 활성화하는 함수\n  const handleDeleteNodeMode = () => {\n    if (!selectedMap) {\n      alert('먼저 맵을 선택해주세요.');\n      return;\n    }\n    setIsDeletingNode(true);\n    document.body.style.cursor = 'not-allowed'; // 커서를 삭제 모드로 변경\n  };\n\n  // Send to Robots 버튼과 관련된 함수 추가\n  const handleSendMap = async () => {\n    const token = localStorage.getItem('token');\n\n    if (!token) {\n      alert('토큰이 없습니다. 다시 로그인해주세요.');\n      return;\n    }\n\n    try {\n      await axios.post('http://172.30.1.30:5559/robot/send_map', {}, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      alert('맵이 로봇에게 성공적으로 전송되었습니다.');\n    } catch (error) {\n      console.error('맵을 로봇에게 전송하는 중 오류 발생:', error);\n      alert(`맵을 로봇에게 전송하는 중 오류 발생: ${error.response?.data?.message || error.message}`);\n    }\n  };\n\n  return (\n    <div className=\"map-management-page\">\n      {/* 상단 네비게이션 바 */}\n      <header className=\"map-management-header\">\n        <UserInfo />\n        <LogoutButton />\n      </header>\n      <Navbar />\n\n      {/* 툴바: 네비게이션 아래에 위치 */}\n      <div className=\"toolbar\">\n        <button onClick={handleCreateNodeMode} className=\"create-node-button\">\n          <FontAwesomeIcon icon={faPlus} /> 노드 생성\n        </button>\n        <button onClick={handleDeleteNodeMode} className=\"delete-node-button\">\n          <FontAwesomeIcon icon={faEdit} /> 노드 삭제\n        </button>\n        <button onClick={handleConnectNodeMode} className=\"connect-node-button\">\n          <FontAwesomeIcon icon={faLink} /> 노드 연결 {/* \"노드 연결\" 버튼 추가 */}\n        </button>\n        <button onClick={handleDisconnectNodeMode} className=\"disconnect-node-button\">\n          <FontAwesomeIcon icon={faUnlink} /> 연결 해제 {/* \"연결 해제\" 버튼 추가 */}\n        </button>\n        {/* '금지 구역 생성' 버튼 추가 */}\n        <button\n          onClick={handleCreateNoGoZone}\n          className=\"create-nogozone-button\"\n        >\n          금지 구역 생성\n        </button>\n      </div>\n\n      {/* 맵 리스트와 이미지 컨텐츠 */}\n      <div className=\"map-management-content\">\n        {/* 맵 리스트 컨테이너 */}\n        <div className=\"map-list-container\">\n          <h2 className=\"map-list-header\">\n            맵 리스트\n            <button\n              onClick={() => setIsUploadPopupOpen(true)}\n              className=\"add-map-button\"\n            >\n              <FontAwesomeIcon icon={faPlus} />\n            </button>\n          </h2>\n          <ul className=\"map-list\">\n            {maps.map((map) => (\n              <li\n                key={map._id}\n                className={`map-list-item ${selectedMap?._id === map._id ? 'selected-map' : ''}`}\n              >\n                <span\n                  onClick={() => handleSelectMap(map)}\n                  className=\"map-list-item-name\"\n                >\n                  {map.name}\n                </span>\n                <button\n                  onClick={() => openEditPopup(map)}\n                  className=\"edit-map-button\"\n                >\n                  <FontAwesomeIcon icon={faEdit} />\n                </button>\n                <button\n                  onClick={() => handleDeleteMap(map._id)}\n                  className=\"delete-map-button\"\n                >\n                  &times;\n                </button>\n              </li>\n            ))}\n          </ul>\n\n          {selectedMap && (\n            <div className=\"map-description\">\n              <h3>맵 설명</h3>\n              <p>{selectedMap.description}</p>\n            </div>\n          )}\n        </div>\n\n        {/* 지도 이미지와 노드 렌더링 및 노드 리스트 영역 */}\n        <div className=\"map-image-and-node-list\">\n          {/* 지도 이미지와 노드 렌더링 영역 */}\n          <div\n            className=\"map-image-container\"\n            style={{ position: 'relative' }}\n            onClick={handleMapClick}\n          >\n            {mapImage ? (\n              <canvas\n                ref={canvasRef}\n                className=\"map-canvas\"\n                style={{ cursor: isCreatingNode ? 'crosshair' : (connectionStep !== 'idle' || disconnectStep !== 'idle') ? 'pointer' : 'default' }} // 커서 스타일 수정\n                onMouseMove={handleMouseMove}\n                onMouseLeave={handleMouseLeave}\n              />\n            ) : (\n              <p>맵을 선택하여 이미지를 확인하세요.</p>\n            )}\n\n            {/* 플로팅 Send to Robots 버튼 추가 */}\n            {selectedMap && (\n              <button\n                className=\"send-to-robots-button\"\n                onClick={handleSendMap}\n              >\n                로봇에게 전송\n              </button>\n            )}\n          </div>\n\n          {/* 오른쪽에 노드 목록 표시 */}\n          <NodeList nodes={nodes} /> {/* NodeList 컴포넌트 사용 */}\n        </div>\n      </div>\n\n      {/* Node 생성 팝업 */}\n      {isNodePopupOpen && (\n        <div className=\"popup-container\">\n          <h3>노드 생성</h3>\n          <p>X: {nodeX.toFixed(2)}, Y: {nodeY.toFixed(2)}</p>\n          <input\n            type=\"text\"\n            value={nodeName}\n            onChange={(e) => setNodeName(e.target.value)}\n            placeholder=\"노드 이름 입력\"\n            className=\"popup-input\"\n          />\n          <div className=\"popup-button-container\">\n            <button onClick={handleSubmitNode} className=\"popup-submit-button\">\n              생성\n            </button>\n            <button\n              onClick={() => setIsNodePopupOpen(false)}\n              className=\"popup-cancel-button\"\n            >\n              취소\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Map Upload Popup */}\n      {isUploadPopupOpen && (\n        <div className=\"popup-container\">\n          <h3>맵 업로드</h3>\n          <form onSubmit={handleUploadMap}>\n            <input\n              type=\"text\"\n              value={uploadName}\n              onChange={(e) => setUploadName(e.target.value)}\n              placeholder=\"맵 이름\"\n              required\n              className=\"popup-input\"\n            />\n            <textarea\n              value={uploadDescription}\n              onChange={(e) => setUploadDescription(e.target.value)}\n              placeholder=\"맵 설명\"\n              required\n              className=\"popup-textarea\"\n            />\n            <label>맵 파일 (.pgm, .png, .jpg)</label>\n            <input\n              type=\"file\"\n              accept=\".pgm,.png,.jpg\"\n              onChange={handleFileChange}\n              required\n              className=\"popup-file-input\"\n            />\n            <label>YAML 파일 (.yaml)</label>\n            <input\n              type=\"file\"\n              accept=\".yaml\"\n              onChange={handleYamlFileChange}\n              required\n              className=\"popup-file-input\"\n            />\n            <div className=\"popup-button-container\">\n              <button type=\"submit\" className=\"popup-submit-button\">\n                업로드\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setIsUploadPopupOpen(false)}\n                className=\"popup-cancel-button\"\n              >\n                취소\n              </button>\n            </div>\n          </form>\n        </div>\n      )}\n\n      {/* Edit Map Popup */}\n      {isEditPopupOpen && (\n        <div className=\"popup-container\">\n          <h3>맵 수정</h3>\n          <form onSubmit={handleUpdateMap}>\n            <input\n              type=\"text\"\n              value={editName}\n              onChange={(e) => setEditName(e.target.value)}\n              placeholder=\"맵 이름\"\n              required\n              className=\"popup-input\"\n            />\n            <textarea\n              value={editDescription}\n              onChange={(e) => setEditDescription(e.target.value)}\n              placeholder=\"맵 설명\"\n              required\n              className=\"popup-textarea\"\n            />\n            {/* 모니터링 지도 설정 체크박스 추가 */}\n            <label style={{ marginTop: '10px', color: '#333' }}>\n              <input\n                type=\"checkbox\"\n                checked={isMonitored}\n                onChange={(e) => setIsMonitored(e.target.checked)}\n                style={{ marginRight: '10px' }}\n              />\n              모니터링 맵으로 설정\n            </label>\n            <div className=\"popup-button-container\">\n              <button type=\"submit\" className=\"popup-submit-button\">\n                업데이트\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setIsEditPopupOpen(false)}\n                className=\"popup-cancel-button\"\n              >\n                취소\n              </button>\n            </div>\n          </form>\n        </div>\n      )}\n\n      {/* Hover Tooltip */}\n      {hoveredNode && (\n        <div\n          className=\"tooltip\"\n          style={{\n            position: 'fixed',\n            top: `${tooltipPosition.y + 10}px`,\n            left: `${tooltipPosition.x + 10}px`,\n            backgroundColor: 'rgba(0, 0, 0, 0.7)',\n            color: 'white',\n            padding: '5px 10px',\n            borderRadius: '4px',\n            pointerEvents: 'none',\n            zIndex: 1000,\n            fontSize: '12px',\n          }}\n        >\n          {hoveredNode.name}\n        </div>\n      )}\n\n      {/* NodeDisconnect 컴포넌트에 클릭한 노드 정보 전달 */}\n      <NodeDisconnect\n        firstNodeId={disconnectFirstNodeId}\n        secondNodeId={disconnectSecondNodeId}\n        onDisconnectSuccess={async (isDeleted) => {\n          if (isDeleted) {  // 삭제가 완료된 경우에만 실행\n            setDisconnectFirstNodeId(null);\n            setDisconnectSecondNodeId(null);\n            await fetchNodes(selectedMap._id); // 노드 정보 갱신\n            drawNodes(); // 갱신된 정보로 노드 및 간선 다시 그리기\n          }\n        }}\n      />\n\n      {/* NoGoZone 컴포넌트 추가 */}\n      {isCreatingNoGoZone && (\n        <NoGoZone\n          mapId={selectedMap?._id}\n          onClose={() => setIsCreatingNoGoZone(false)}\n          onNoGoZoneCreated={async () => {\n            await fetchNoGoZones(selectedMap._id);\n            setIsCreatingNoGoZone(false);\n            drawNodes(); // 노드 및 금지구역 다시 그리기\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default Mapmanage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}